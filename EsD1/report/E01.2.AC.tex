\documentclass[10pt, a4paper, italian]{article}
\input{../../latex/preamble}
\input{../../latex/math}
\usepackage{multicol}
\usepackage{diagbox}
\geometry{left=2cm, right=2cm, top=2cm, bottom=2cm}

% indexes subsections with letters, sections with numbers (1.a, 1.b, ...)
\renewcommand{\thesubsection}{\thesection.\alph{subsection}}

% lets graphicx know path where figures to be included are found
\graphicspath{{../figs/}}

\author{Gruppo 1.AC \\ Matteo Rossi, Bernardo Tomelleri}
\title{EsD1: Caratterizzazione di porte logiche e semplici circuiti logici.}
\begin{document}
\date{\today}
\maketitle

\section*{Misura componenti dei circuiti}
\begin{table}[htbp]
\centering
\begin{tabular}{ccc}
\toprule
Resistenze $[\si{\ohm}]$ & $R$ & $\sigma R$ \\
\midrule
\midrule
$R\ped{pot1}$	& 9.53 k	& 0.08 k 		\\
$R\ped{pot2}$	& 9.78 k	& 0.08 k 		\\

\bottomrule     
\end{tabular}
\caption{Valori di resistenza misurati per i componenti passivi dei circuiti
studiati. \label{tab: rmesM}}
\end{table}

Riportiamo per completezza anche il valore della tensione continua di
alimentazione per i circuiti integrati misurata con il multimetro
\begin{align*}
V_{CC} &= 4.99 \pm 0.03 \si{\V} \\
\end{align*}

\subsection*{Nota sul metodo di fit}
Per determinare i parametri ottimali e le rispettive covarianze si \`e
implementato in \verb+Python+ un algoritmo di fit basato sui minimi quadrati
mediante la funzione \emph{curve\_fit} della libreria \texttt{SciPy}.

\setcounter{section}{0}
%=======================
\section*{Parte A: Caratteristiche fisiche delle porte logiche}
Si studia il comportamento delle porte NOT TTL contenute nel circuito integrato SN7404 misurando le tensioni e correnti di operazione e verificando che queste rientrino nelle specifiche tecniche riportate nel Data-Sheet del chip in \cref{fig: SN7404}.
\begin{minipage}{0.3\textwidth}
    \includegraphics[width=\textwidth]{SN7404}
    
    \label{fig: SN7404}
\end{minipage}

\section{Tensioni di operazione}\label{sec: tens}
Per prima cosa misuriamo i valori delle tensioni di soglia in ingresso e in
uscita (e verifichiamo che rispettino le specifiche di buon funzionamento del
DS) da cui è possibile ottenere una misura del Noise Margin delle porte.

Dalle specifiche del DS si ha che i valori attesi sono: (riportati in
\cref{tab: notDS})
\begin{table}[htb]
\centering
\begin{tabular}{cccc|c}
\toprule
Parameter  & min & typ & max & [Unit] \\
\midrule
\midrule
$V_{CC}$ &  &  & $7$ & V \\
$V_I$	 &  &  & $5.5$ & V\\
$V_{OH}$ & $2.4$  & $3.4$ & & V \\
$V_{OL}$ &   & $0.2$ & $0.4$ & V \\
$V_{IH}$ & $2$  &  & & V  \\
$V_{IL}$ &  &  & $0.8$ & V \\
$I_{IH}$ &  &  & $40$ & $\si{\micro\A}$ \\
$I_{OH}$ &  &  & $-0.4$ & mA \\
\bottomrule 
\end{tabular}
\caption{Valori delle tensioni e correnti di operazione indicati sul
datasheet dell'integrato SN7404.}
\label{tab: notDS}
\end{table}

in cui $V_O$ e $V_I$ sono definite come le tensioni in uscita e in ingresso
dalla porta logica (le altre diciture indicano se la grandezza a cui facciamo
riferimento corrisponde a uno stato logico alto (H) o basso (L) e quali sono
i massimi o minimi valori garantiti dal costruttore).

\subsection{Misura delle tensioni di soglia dal grafico
$V\ped{out}(V\ped{in})$}
Generiamo una rampa di tensione compresa tra 0-5 V e la inviamo
all'ingresso di una porta NOT per osservare i segnali generati in uscita,
così da ottenere un grafico di $V\ped{out}$ in funzione di $V\ped{in}$.

Abbiamo quindi utilizzato i cursori per misurare $V_{OH}$ e $V_{OL}$, cioè
la tensione che raggiunge l'uscita in saturazione per valore logico H e L
rispettivamente, mentre per misurare $V_{IL}$ e $V_{IH}$ abbiamo misurato le
tensioni in ingresso per cui inizia e finisce la commutazione dell'uscita
secondo lo schema in \cref{fig: trans}:
\begin{figure}[htbp]
\centering
	\includegraphics[width=\textwidth]{trans}
	\caption{Schema di come sono stati utilizzati i cursori per misurare le tensioni $V_{OH}$, $V_{OL}$ (cursori orizzontali) e $V_{IH}$, $V_{IL}$ (aiutandosi con i cursori verticali a individuare la fase di transizione H->L)}
	\label{fig: trans}
\end{figure}
\begin{multicols}{2}
    \centering
    $V_{OH} = 3.78 \pm 0.03\; \si{\V}$ \\
	$V_{OL} = 632 \pm 4 \; \si{m\V}$ \\
	$V_{IH} = 2.10 \pm 0.02 \; \si{\V} $\\
	$V_{IL} = 979 \pm 9\; \si{m\V} $\\
    
    $V_{OH} = 3.76 \pm 0.03\; \si{\V}$ \\
	$V_{OL} = 341 \pm 3 \; \si{m\V}$ \\
	$V_{IH} = 1.81 \pm 0.02 \; \si{\V} $\\
	$V_{IL} = 772 \pm 8\; \si{m\V} $\\
\end{multicols}

\begin{figure}[htbp]
\centering
	\includegraphics[scale=0.4]{not_xy1}
	\caption{Grafico XY di $V\ped{out}$ in funzione di $V\ped{in}$}
\end{figure}
\begin{figure}[htbp]
\centering
	\includegraphics[width=\textwidth]{not_time1}
	\caption{Grafico in funzione del tempo di $V\ped{in}$ (in giallo, una rampa da 0 a 5 V di frequenza pari a 1 kHz) e $V_{out}$ (in blu)}
\end{figure}

Sempre con i cursori abbiamo misurato $V\ped{OH, min}$ dato che il valore
minimo per lo stato alto dell'uscita risultava più basso di
quanto misurato prima; di conseguenza abbiamo spostato il cursore nel punto
in cui la tensione in uscita cambia in maniera più repentina:
\begin{figure}
\centering
	\includegraphics[scale=0.4]{trans1}
	\caption{Schema di come è stata presa la misura di $V\ped{OH, min}$ tramitel'utilizzo dei cursori: è stato scelto come valore minimo la tensione dell'uscita subito prima del primo cambio repentino.}
	\label{fig: trans1}
\end{figure}
Successivamente si sono utilizzati gli altri valori presi in precedenza per completare le misure.
Per il primo integrato:
\begin{multicols}{2}
    \centering
    $V\ped{OH, min}=$ 2.53 $\pm$ 0.03 V\\
    $V\ped{IH, min}=$ 2.10 $\pm$ 0.02 V\\
    
    $V\ped{IL, max}=$ 979 $\pm$ 9 mV\\
    $V\ped{OL, max}=$ 632 $\pm$ 4 mV\\
\end{multicols}
mentre per il secondo:
\begin{multicols}{2}
    \centering
    $V\ped{OH, min}=$ 2.40 $\pm$ 0.03 V\\
    $V\ped{IH, min}=$ 1.81 $\pm$ 0.02 V\\
%    $NM_H=$ 0.60 $\pm$ 0.04 V
    
    $V\ped{IL, max}=$ 772 $\pm$ 8 mV\\
    $V\ped{OL, max}=$ 341 $\pm$ 3 mV\\
%    $NM_L=$ 0.43 $\pm$0.01 V
\end{multicols}

Da cui troviamo le nostre stime dei valori delle soglie di rumore (Noise
Margin High e Low) per le porte NOT studiate, definite come
\begin{multicols}{2}
\begin{align*}
NM_H = V\ped{OH, min} - V\ped{IH, min} &= (0.43 \pm 0.04) \; \si{\V} \\
    &= (0.60 \pm 0.03) \; \si{\V}
\end{align*}

\begin{align*}    
NM_L = V\ped{IL, max} - V\ped{OL, max} &= (0.35 \pm 0.02) \; \si{\V} \\
    &= (0.43 \pm 0.02) \; \si{\V}
\end{align*}
\end{multicols}

\subsection{Valori attesi per le soglie di rumore}
Estrapolando i corrispettivi valori dal datasheet, e assumendo che ogni porta
logica abbia i medesimi parametri delle altre presenti nello stesso integrato
possiamo allora ricavare i valori attesi dei Noise Margin High e Low:
\begin{align*}
NM_H = 2.4 - 2 = 0.4 \; \si{\V} \\
NM_L = 0.8 - 0.4 = 0.4 \; \si{\V}
\end{align*}

\subsection{Confronto dei risultati}
Le nostre misure risultano compatibili con le aspettative entro gli intervalli
ammessi dal datasheet per il buon funzionamento del componente, dunque anche
le grandezze derivate risultano in accordo con le aspettative.

\section{Misura (statica) del Fan-out}
Chiamiamo Fan-Out il massimo numero di porte che una singola porta è in grado
di pilotare rimanendo entro le specifiche di funzionamento del datasheet, lo
si è definito come
\[
\text{FO}= \abs{\frac{I\ped{IH, max}}{I\ped{OH, max}}}
\]

\subsection{Misura della corrente in ingresso alla porta NOT nello stato alto}
Misuriamo la corrente $I\ped{IH, max}$ per entrambi gli integrati collegando
l'amperometro in serie tra l'ingresso della porta logica e l'uscita del
canale WaveGen1 dell'AD2, quindi generando in questo canale una tensione
continua di livello alto pari a 5 V, da cui si trova
\begin{align*}
    I\ped{IH, 1} &= 16 \pm 1 \; \si{\micro\A} \\
    I\ped{IH, 2} &= 10 \pm 1 \; \si{\micro\A} \\   
\end{align*}
Che risultano essere compatibili entro i limiti del datasheet.

\subsection{Misura della corrente in uscita dalla porta NOT per VOH tipico}
Successivamente abbiamo inviato all'ingresso della porta un segale DC a 0 V
(sempre utilizzando il canale WG1) e abbiamo inserito un potenziometro da
$10 \; \si{k\ohm}$ in serie all'uscita di questa per misurare la corrente che
scorre attraverso questa ``resistenza di carico'' regolabile in modo da
avere quando una tensione in uscita dalla porta corrispondente al valore
tipico di $V_{OH}= 3.40 \pm 0.03 \; \si{\V}$.
\begin{align*}
    I\ped{OH, 1} &= 495 \pm 4 \; \si{\micro\A} \\
    I\ped{OH, 2} &= 315 \pm 3 \; \si{\micro\A} \\   
\end{align*}

\subsection{Misura della corrente in uscita dalla porta NOT per VOH tipico}
%TODO inseirire cosa sarebbe successo se avessi abbassato la tensione in
%uscita ai valori di VOH 2.5 V (min) o 3.8 V (saturazione) circa

\subsection{Misura indiretta del fan-out}
Dalle misure di corrente sui due integrati ricaviamo finalmente che:
\begin{align*}
    \text{FO}_1 &= 31 \pm 2 \\
    \text{FO}_2 &= 32 \pm 3 \\
\end{align*}

\subsection{Valore del fan-out atteso e confronto}
Dalle specifiche del DS elencate sopra in \ref{tab: notDS} risulta che
\begin{align*}
    I\ped{IH, max}= -0.4 \; \si{m\A} \\
    I\ped{OH, max}= 40 \; \si{\micro\A} \\
    \text{FO} = 10
\end{align*}
I valori da noi trovati risultano sensibilmente più alti delle aspettative
e non compatibili con queste, ma perlomeno rimangono compatibili tra di loro.

\section{Tempi di propagazione}
Vogliamo ora misurare i tempi di propagazione della porta logica NOT
osservando (tramite un oscilloscopio da banco) l'andamento nel tempo dei
segnali nei pin di ingresso uscita della porta durante le transizioni di stato
per poi paragonarli ai valori riportati sul datatsheet in analogia a quanto
fatto finora.

\subsection{Definizione e valori attesi dei tempi di propagazione}
Dal datasheet TI fornito le misure di tempi di propagazione per la commutazione
dell'uscita tra gli stati alto->basso $t_{PHL}$ e basso->alto $t_{PLH}$ sono
definite come l'intervallo di tempo tra il passaggio della forma d'onda in
ingresso e di quella in uscita dal livello di tensione iniziale al punto
medio tra lo stato iniziale e finale, secondo lo schema in 

\begin{figure}[htbp]
\centering
	\includegraphics[scale=0.4]{notdelay}
	\caption{Diagramma dei tempi di propagazione per una porta NOT}
\end{figure}

Prendiamo quindi come definizione di tempo di propagazione il lasso di tempo
che trascorre tra quando $V\ped{in}$ diventa pari a $V\ped{I, med}$ e
$V\ped{out}$ diventa pari al suo $V\ped{O, med}$, dove i valori medi tra stato
basso e stato alto rispettivamente per l'ingresso e per l'uscita sono
definiti intuitivamente dalle formule
\begin{align*}
V\ped{O, med} &= \frac{V_{OH} + V_{OL}}{2} \\
V\ped{I, med} &= \frac{V_{IH} + V_{IL}}{2} \\
\end{align*}

Dal datasheet si ricavano come tempi di propagazione attesi:
\begin{align*}
    t_{PHL,max} &= 22 \; \si{n\s} \\
    t_{PLH,max} &= 15 \; \si{n\s} \\
\end{align*}

\subsection{Misura dei tempi con l'oscillografo}
Come visto anche nella \cref{sec: tens}, inviando in ingresso un'onda quadra
compresa tra 0 e 5 V, all'uscita della porta troviamo la stessa onda compresa
tra $V_{OH} \approx 3.6 \; \si{\V}$ e $V_{OL} \approx 0.3  \; \si{V}$;
infatti misurando con i cursori e con l'oscilloscopio troviamo come
\begin{align*}
V\ped{O, med} = 1.95 \pm 0.02 \\
V\ped{I, med} = 2.50 \pm 0.03 \\
\end{align*}

Quindi, una volta collegati i due canali all'ingresso (CH1) e all'uscita (CH2)
del not gate, abbiamo scelto come evento di trigger il passaggio del segnale
di ingresso per $V_{I,med}$, abbiamo dunque cambiato il fronte tra
salita/discesa per scegliere se misurare il tempo di propagazione H->L o L->H.
\begin{figure}[htbp]
\centering
	\includegraphics[width=\textwidth]{LH1}
	\caption{Acquisizione tramite oscilloscopio digitale della transizione da
	L a H per il primo integrato}
\end{figure}
\begin{figure}[htbp]
\centering
	\includegraphics[width=\textwidth]{LH2}
	\caption{Acquisizione tramite oscilloscopio digitale della transizione da
	L a H per il secondo integrato}
\end{figure}
\begin{figure}[htbp]
\centering
	\includegraphics[width=\textwidth]{HL1}
	\caption{Acquisizione tramite oscilloscopio digitale della transizione da
	H a L per il primo integrato}
\end{figure}
\begin{figure}[htbp]
\centering
	\includegraphics[width=\textwidth]{HL2}
	\caption{Acquisizione tramite oscilloscopio digitale della transizione da
	H a L per il secondo integrato}
\end{figure}

Dalla misura fatta con i cursori sull'oscilloscopio si ricava
\begin{multicols}{2}
    \centering
    $t_{PLH}=$ 5.2 $\pm$ 0.2 \si{n\s} \\
    $t_{PHL}=$ 25.0 $\pm$0.2 \si{n\s}
    
    $t_{PLH}=$ 7.0 $\pm$0.2 \si{n\s} \\
    $t_{PHL}=$ 22.0 $\pm$0.2 \si{n\s}
\end{multicols}

\subsection{Confronto con i valori attesi}
Dobbiamo però constatare la presenza di capacità parassite presenti all'interno del circuito: aumentando la scala dei tempi ci accorgiamo che i grafici prodotti dall'oscilloscopio sono qualitativamente simili alle curve di carica e scarica del condensatore(figura \cref{fig: carica}); per questo motivo andando a misurare il tempo di propagazione della porta abbiamo misurato un tempo di propagazione $t_{PHL}$ del primo integrato più alto rispetto a quello aspettato. Presa considerazione di ciò, non è stato possibile riprendere la misura in condizioni in cui la capacità parassita fosse inferiore, e nel migliore dei casi abbiamo ottenuto sempre $t_{PHL}=25.0 \pm 0.2 \; \si{n\s}$.
\begin{figure}[htbp]
\centering
	\includegraphics[width=\textwidth]{carica}
	\label{fig: carica}
	\caption{Acquisizione con oscilloscopio digitale con un fondo scala dei tempi più grande, in modo da osservare qualitativamente come la propagazione del segnale assomigli molto al grafico della tensione ai capi di un condensatore durante il ciclo di carica/scarica}
\end{figure}
Possiamo però concludere che le misure sono compatibili con quanto dichiarato nel datasheet con uno scarto del $14 \; \percent$.

\setcounter{section}{3}
%=======================
\section*{Parte B: Circuiti logici elementari con sole porte NAND}
La caratteristica più fondamentale delle porte NAND è la loro universalità,
infatti è possibile realizzare qualsiasi tipo di circuito logico tramite
combinazione di sole porte NAND (o NOR). In questa parte intendiamo costruire
e verificare il funzionamento di circuiti equivalenti a porte OR, XOR e
multiplexer a partire da soli chip NAND SN74LS00.

\begin{figure}[htbp]
\centering
    \includegraphics[width=\textwidth]{NAND}
    \caption{Schema circuitale del circuito integrato SN74LS00}
    \label{fig: NAND}
\end{figure}

\section{Tabella di verità}

\subsection{Verifica del funzionamento con Logic Analyzer}
Definiamo dentro lo strumento Patterns (generator) di WaveForms 2 segnali
di clock rispettivamente a 100 Hz (in uscita dalla porta DIO0) e l'altro a 200 Hz (in uscita dalla porta DIO1) in modo che la loro combinazione producesse tutte le coppie di valori possibili ottenibili con 2 bit.
Dunque si sono pilotati i due ingressi di una stessa porta nand utilizzando i segnali generati, inviandone uno ad ogni entrata.
Si è usato lo strumento Logic (Analyzer) per acquisire gli andamenti nel tempo dei due segnali in entrata e di quello in uscita:
\begin{figure}[htbp]
\centering
	\includegraphics[scale=0.4]{nand_time}
	\caption{Acquisizione di Logic di una porta nand guidata da due segnali da
	DIO0 (100 Hz) e DIO1 (200 Hz); in uscita viene letto da DIO2}
	\label{nand_time}
\end{figure}
Il circuito risulta essere funzionante e l'output risulta essere L se e solo
se i pin 1 e 2 valgono entrambi H, proprio come da aspettative.

\section{Costruzione di circuiti con porte NAND}
\subsection{Porta OR}
Come primo circuito costruiamo una porta OR: detti \textit{A} e \textit{B}
gli ingressi e \textit{Y} l'uscita, nella notazione dell'algebra booleana si ha
\[
    Y = A + B
\]
Sfruttando la legge di De Morgan si ottiene
\[
    Y = A + B = \overline{\overline{A}\cdot\overline{B}}
\]
che descrive la relazione OR in termini del NAND.\\
Nota la relazione per ottenere un NOT utilizzando porte NAND, riportiamo lo schema del circuito
\begin{figure}[htbp]
    \centering
    \includegraphics[width=0.45\textwidth]{NAND_OR}
    \caption{\label{fig: OR} Schema circuitale utilizzato per costruire un OR GATE: A e B sono i segnali di input, mentre O è l'output}
\end{figure}

Utilizzando le funzioni pattern e logic abbiamo inviato tramite i pin DIO0 e DIO1 2 segnali di clock di frequenza 50 e 100 Hz e abbiamo utilizzato la porta DIO2 per verificare l'output del circuito
\begin{figure}[htbp]
    \centering
    \includegraphics[width=\textwidth]{or_time}
    \caption{Acquisizione Logic per il circuito OR costruito tramite NAND: DIO0 e DIO1 sono i segnali in input, DIO2 è l'output}
\end{figure}
Si vede quindi che il circuito ha il funzionamento aspettato con l'output L se e solo se i due input sono entrambi L.

\subsection{Circuito selettore a due vie (multiplexer)}
Realizziamo un circuito che permetta di assegnare all'uscita il valore di uno dei due ingressi a singolo bit tramite il valore di un terzo ingresso.
Indichiamo con \textit{A}, \textit{B} e \textit{C} gli ingressi e con \textit{Y} l'uscita; 
    \[
    \begin{cases}
    C=0 \implies Y=A\\
    C=1 \implies Y=B
    \end{cases}
    \]
il funzionamento del nostro circuito può essere descritto dalla tabella di Karnaugh riportata sotto\\
\begin{table}
    \centering
    \begin{tabular}{c||c|c|c|c}
        \backslashbox{C}{AB} & 00 & 01 & 11 & 10\\
        \hline
        \hline
        0 & 0 & 0 & 1 & 1\\
        \hline
        1 & 0 & 1 & 1 & 0\\
    \end{tabular}
\end{table}

da cui si ricava facilmente la seguente relazione per il circuito
\[
Y=A\cdot\overline{C}+B\cdot C
\]
e, sempre sfruttando De Morgan, si ha
\[
Y=A\cdot\overline{C}+B\cdot C=\overline{(\overline{A\cdot\overline{C}})\cdot(\overline{B\cdot C})}
\]
Riportiamo sotto lo schema del circuito
\begin{figure}[htbp]
    \centering
    \includegraphics[width=0.6\textwidth]{NAND_MP.png}
    \caption{Schema circuitale per costruire un multiplexer a 2 input, controllato dal valore logico C}
    \label{circuito2}
\end{figure}

Per dimostrare il corretto funzionamento del circuito riportiamo le acquisizioni di Pattern, in cui è possibile comprendere come sono stati impostati gli ingressi, e Logic, da cui si può verificare il corretto funzionamento del circuito.
Abbiamo inviato al circuito tramite la funzione pattern un segnale di clock a 100 Hz a B, uno a 50 Hz a A e infine uno a 25 Hz a C.
\begin{figure}[htbp]
    \centering
    \includegraphics[width=0.8\textwidth]{pat2.png}
    \caption{Logic: DIO 0 $\equiv$ B, DIO 1 $\equiv$ A, DIO 2 $\equiv$ C}
    \label{logic2}
\end{figure}
\begin{figure}[htbp]
    \centering
    \includegraphics[width=0.8\textwidth]{Multiplex.png}
    \caption{Logic: DIO 0 $\equiv$ B, DIO 1 $\equiv$ A, DIO 2 $\equiv$ C, DIO 3 $\equiv$ Y}
    \label{logic2}
\end{figure}
Si ricava quindi che il circuito funziona come da aspettative, restituendo il segnale di A nel caso in cui C=0 e il segnale B quando C=1.


\subsection{Porta XOR}
Un circuito \texttt{XOR} si può realizzare con 4 porte \texttt{NAND} partendo
dalla sua equazione caratteristica e manipolandola con le leggi di De Morgan:
\begin{align*}
  A \oplus B &= (A \cdot \overline{B}) + (\overline{A} \cdot B)
             =  (A \cdot \overline{A} + A \cdot \overline{B}) + (B \cdot \overline{B} + \overline{A} \cdot B) \\
             &= A \cdot (\overline{A} + \overline{B}) + B \cdot (\overline{B} + \overline{A})
             = A \cdot \overline{(A \cdot B)} + B \cdot \overline{(B \cdot A)} \\
\end{align*}
\begin{figure}[htbp]
    \centering
    \includegraphics[width=0.6\textwidth]{NAND_XOR.png}
    \caption{Schema circuitale utilizzato per costruire uno XOR GATE tramite NAND}
    \label{circuito3}
\end{figure}

\begin{figure}[htbp]
    \centering
    \includegraphics[width=0.8\textwidth]{xor_time.png}
    \caption{Acquisizione Logic della Porta XOR: DIO0 e DIO1 sono i segnali di input, DIO2 è l'uscita dallo XOR}
    \label{pat2}
\end{figure}

Se ne deduce che il circuito ha il funzionamento aspettato e che quindi l'output risulta essere L se e solo se entrambi gli input A e B hanno lo stesso valore.

\setcounter{section}{5}
%=======================
\section*{Parte C: Circuiti logici complessi a più chip}
\section{Convertitore Gray-Binario}
\begin{minipage}{0.7\textwidth}
    Come ultima cosa vogliamo realizzare un circuito in grado di convertire un valore a 4 bit dalla codifica Gray in Binario utilizzando un solo integrato di tipo SN74LS86 a porte XOR, descritto nella figura a lato.\\
    Un convertitore Gray-Binario può essere schematizzato come in Figura (\ref{gb}): il nostro obiettivo è quello di verificare che tale circuito si comporti come atteso.
\end{minipage}
\begin{minipage}{0.3\textwidth}
    \includegraphics[width=\textwidth]{XOR.png}
\end{minipage}
\newline
\begin{minipage}{0.5\textwidth}
    \centering
    \includegraphics[width=0.8\textwidth]{gb.png}
    \captionof{figure}{Schema convertitore Gray-Binario}
    \label{gb}
\end{minipage}

\begin{table}[htbp]
    \centering
    \begin{tabular}{c||c}
        Codice binario & Codice Gray \\
        \hline
        \hline
        0000 & 0000\\
        0001 & 0001\\
        0010 & 0011\\
        0011 & 0010\\
        0100 & 0110\\
        0101 & 0111\\
        0110 & 0101\\
        0111 & 0100\\
        1000 & 1100\\
        1001 & 1101\\
        1010 & 1111\\
        1011 & 1110\\
        1100 & 1010\\
        1101 & 1011\\
        1110 & 1001\\
        1111 & 1000\\
        \end{tabular}
    \caption{Conteggio a 4 bit nei due codici.}
    \label{tab: grbin}
\end{table}

Il codice Gray differisce dal codice binario in quanto si passa da un intero al successivo modificando un solo bit per volta.\\
Calcoliamo l'uscita del circuito per alcuni valori in ingresso:
\begin{table}[htbp]
    \centering
    \[
    \begin{array}{cccc|cccc}
        G_3 & G_2 & G_1 & G_0 & B_3 & B_2 & B_1 & B_0\\
        \hline
        0 & 0 & 0 & 0 & 0 & 0 & 0 & 0\\
        1 & 1 & 1 & 1 & 1 & 0 & 1 & 0\\
        1 & 0 & 0 & 1 & 1 & 1 & 1 & 0\\
        1 & 0 & 0 & 0 & 1 & 1 & 1 & 1\\
    \end{array}
    \]
\end{table}

Confrontando le uscite ottenute con i valori riportati in \cref{tab: grbin} affermiamo che il circuito si comporta correttamente come convertitore Gray-Binario. Come conferma, riportiamo un'acquisizione.\\
\begin{figure}[htbp]
    \centering
    \includegraphics[width=\textwidth]{graybin}
    \caption{Acquisizione di un ciclo completo (frequenza 1 kHz) con Logic
    Analyzer dei segnali in ingresso e in uscita dal convertitore Gray-binario.}
\end{figure}
\begin{figure}[htbp]
    \centering
    \includegraphics[width=\textwidth]{gray20ns}
    \caption{Acquisizione del Logic Analyzer durante la transizione dal numero $15$ al numero $0$ su scala dei tempi pari a $20$ ns.}
\end{figure}
\begin{figure}[htbp]
    \centering
    \includegraphics[width=\textwidth]{gray10ns}
    \caption{\label{fig: prop}Transizione dal $15$ allo $0$ su scala temporale pari a $10$ ns.}
\end{figure}
Per una scala dei tempi molto stretta, abbiamo triggerato quando il MSB del bus a codice Gray cade da H a L: in questo modo riusciamo a osservare la transizione da 15 a 1 (1000 in Gray equivale a 1111 in binario) e a vedere come si comporta la propagazione del segnale.
Dalla figura \cref{fig: prop} notiamo che anche se il bit 3 del segnale Gray e il bit 3 del codice binario sono direttamente collegati tra loro (senza nessuna porta logica nel mezzo), quest'ultimo percepisce un ritardo pari a circa la risoluzione temporale dell'AD2 (che risulta essere 10 \si{n\s}).
Inoltre i successivi bit del codice binario (2,1 e infine 0) risultano anch'essi ritardati dal bit precedente a quello preso in considerazione perché in mezzo vi si trova una porta logica XOR: andando a controllare sul datasheet il tempo di propagazione per la porta XOR si ricava che nel caso in cui l'altro ingresso sia su uno stato logico basso, $t_{PHL,typ}=10 \; \si{n\s}$ e $t_{PHL,max}=17 \; \si{n\s}$.
Considerando quindi che il ritardo totale (da quando il bit MSB Gray scende a 0, fino a quando il bit LSB Binario scende anch'esso a 0) risulta essere pari 50 \si{n\s}, possiamo verificare che questo combacia approssimativamente con le aspettative per cui 3 porte XOR inducono un ritardo di $\approx 30$ \si{n\s} e il primo bit binario (MSB) subisce anch'esso un ritardo di 10 \si{n\s}, portando il ritardo atteso approssimativamente a circa 40 \si{n\s}.
Il ritardo "fantasma" misurato con l'AD2 presente dal momento in cui il bit 2 Binario scende a 0 fino a quando anche il bit 1 scende a 0 (indicativamente in figura \cref{fig: prop} tra i 20 e i 30 \si{n\s}) lo si può invece attribuire alla scarsa risoluzione dell'AD2  (che ripetiamo essere 10 \si{n\s}) e ad una porta logica con un tempo di propagazione particolarmente più elevato rispetto alle altre (in particolare ci aspettiamo sia la porta XOR che in uscita ha il bit B1).

\section{Sommatore a 2 bit}
Vogliamo costruire un sommatore a due bit utilizzando le dovute porte logiche. Utilizzeremo i chip \texttt{SN74LS08} (quad-AND), \texttt{SN74LS32} (quad-OR), \texttt{SN74LS86} (quad-XOR). Il circuito da montare è riportato in \cref{fig: sommatore}.

\begin{figure}[htbp]
    \centering
    \includegraphics[width=0.6\linewidth]{half.png}
    \caption{Schema circuitale di un half adder}
    \label{fig:halfadder}
\end{figure}

\begin{figure}[htbp]
    \centering
    \includegraphics[width=0.6\linewidth]{full.png}
    \caption{Schema circuitale di un full adder.}
    \label{fig:fulladder}
\end{figure}
\subsection{Verifica Half Adder e Full Adder}
Si vuole quindi verificare il funzionamento dei due circuiti Half Adder e Full Adder:
per verificare il funzionamento del primo è stato sufficiente generare con pattern
un bus contatore a 2 bit che conta in binario e abbiamo inviato i segnali dei due bit uno ad ogni ingresso dell'HA.
\begin{figure}[htbp]
	\centering
	\includegraphics[width=\textwidth]{half_time}
	\caption{Acquisizione Logic del funzionamento di un half adder}
\end{figure}
Per verificare il funzionamento del Full Adder abbiamo generato con pattern un bus
contatore (come prima in binario) a 3 bit: 2 di questi (i due bit meno significativi) sono stati utilizzati come ingressi A e B, mentre il MSB è stato utilizzato come bit di CARRY IN.
\begin{figure}[htbp]
	\centering
	\includegraphics[width=\textwidth]{full_time}
	\caption{Acquisizione Logic del funzionamento di un full adder}
\end{figure} 
Dai risultati ottenuti con le acquisizioni di Logic si verifica che entrambi i circuiti funzionano come da aspettativa.
\subsection{Sommatore}
Abbiamo quindi collegato l'uscita CARRY OUT  dell'half adder all'entrata CARRY IN dell full adder: così facendo si ottiene un sommatore binario a 2 bit con bit di riporto (che andrà ad indicare un eventuale overflow).
\begin{figure}[htbp]
    \centering
    \includegraphics[width=0.6\linewidth]{sum.png}
    \caption{Schema circuitale di un sommatore a 2 bit}
    \label{fig: sommatore}
\end{figure}

A questo punto si procede con la verifica di funzionamento del circuito; per questo motivo abbiamo generato un Bus contatore a 4 bit che utilizzeremo per inviare numeri in binario in ingresso al sommatore.
In particolare i 2 bit meno significativi del bus formeranno il numero A, mentre i restanti saranno B.
A questo punto si sono inviati questi 2 numeri alle entrate del sommatore facendo attenzione a inserire nel Half Adder i due bit meno significativi di entrambi i numeri, mentre al Full Adder i due bit più significativi.

\begin{figure}[htbp]
    \centering
    \includegraphics[width=\linewidth]{sum_time.png}
    \caption{Acquisizione Logic per il sommatore a 2 bit: DIO0 e DIO1 rappresentano il numero A; DIO2 e DIO3 rappresentano B; DIO4, DIO5 e DIO6 rappresentano invece rispettivamente il risultato della somma (con DIO4 il LSB) e il bit di overflow}
    \label{fig: faAD2}
\end{figure}
Si verifica quindi che il circuito sommatore funziona come atteso.
\subsection{Verifica funzionamento tramite led}

Aggiungiamo al circuito 4 led verdi e un led rosso: questi sono pilotati da 5 nuovi cavi dell'AD2. Per controllare il loro funzionamento aggiungiamo a \emph{Patterns} una tabella di verità, riportata in \cref{fig: Ver}, che faccia in modo che ad ogni step si illuminino un numero di led pari al valore della somma. Il led rosso verrà usato per controllare l'overflow, ovvero la possibilità che il risultato sia maggiore o uguale a 4.

\begin{figure}[htbp]
    \centering
    \includegraphics[width=0.8\linewidth]{TAB_LED}
    \caption{Tabella delle verità usata per il controllo dei led.}
    \label{fig: Ver}
\end{figure}

Si è fatta quindi un'ultima acquisizione tramite Logic includendo anche i segnali inviati nei LED


\begin{figure}[htbp]
    \centering
    \includegraphics[width=0.8\linewidth]{sum_time_ROM}
    \caption{Acquisizione con logic dell'andamento dei vari segnali per il circuito Sommatore a 2 bit il cui risultato pilota la tabella di verità presente in \cref{Ver}.}
    \label{fig: ROM_sommatore} %I RUMENI SOTTO I TRENI DIO SCHIFOSO
\end{figure}
Da cui come ci si aspetta l'ultimo LED verde non si accende mai (dato che con 2 bit riesco a rappresentare solo i numeri fino a 3) e solo il LED rosso si accende quando il bit di CARRY ha valore logico alto.
%=======================
\section*{Conclusioni e commenti finali}
Si è riusciti a verificare il corretto comportamento delle porte TTL studiate
caratterizzandone le tensioni, correnti di operazione e tempi caratteristici
di circuiti integrati come il SN7404.
Inoltre, è stato possibile verificare il funzionamento di circuiti logici di
diversa complessità costruiti con porte NAND, XOR, e OR e si è riusciti ad
apprezzare l'effetto dei tempi di propagazione delle porte nella conversione
dalla codifica Gray al binario.

%=======================
\section*{Dichiarazione}
I firmatari di questa relazione dichiarano che il contenuto della relazione \`e
originale, con misure effettuate dai membri del gruppo, e che tutti i firmatari
hanno contribuito alla elaborazione della relazione stessa.

\end{document}
