\documentclass[10pt,a4paper]{article}
\input{../../latex/preamble}
\input{../../latex/math}
\geometry{left=2cm, right=2cm, top=2cm, bottom=2cm}

% indexes subsections with letters, sections with numbers (1.a, 1.b, ...)
\renewcommand{\thesubsection}{\thesection.\alph{subsection}}

% lets graphicx know path where figures to be included are found
\graphicspath{{../figs/}}

\author{Gruppo 1.AC \\ Matteo Rossi, Bernardo Tomelleri}
\title{Es03A: Amplificatore a transistor}
\begin{document}
\date{\today}
\maketitle

\setcounter{section}{0}

\section*{Misura componenti del circuito}
\begin{table}[ht]
\centering
\begin{tabular}{cccccc}
\toprule
Resistenze $[\si{\ohm}]$ & $R$ & $\sigma R$ & Capacità $[\si{\F}]$ & $C$ &
$\sigma C$ \\
\midrule
\midrule
$R_C$		  & 5.06 k	& 0.04 k	 & $C\ped{in}$  & 0.23 $\rm \mu$ & 0.01 $\rm \mu$ \\
$R_{E_p}$	  & 992		& 8      & $C\ped{out}$ & 104 n			 & 4	\\
$R_{E_q}$	  & 993		& 8      & $C_E$        & 90 $\rm \mu$	 & 5	\\
$R_{E}$		  & 496		& 4      &              &				 &		\\
$R_{1_s}$	  & 19.87 k & 0.16 k &              &				 &		\\
$R_{1_t}$	  & 50.5 k  & 8 k	 &              &				 &		\\
$R_1$		  & 70.4 k  & 0.6 k	 &              &				 &		\\
$R_2$		  & 9.93 k  & 0.08 k &              &				 &		\\
$R\ped{es_p}$ & 100.5	& 0.8    &				&				 &		\\
$R\ped{es_q}$ & 100.2	& 0.8    &				&				 &		\\
$R\ped{es}$   & 50.5	& 0.5    &				&				 &		\\
\bottomrule     
\end{tabular}
\caption{Valori di resistenza e capacità misurate per i componenti del
circuito \label{tab: rcmes}}
\end{table}
Riportiamo per completezza anche il valore calcolato della resistenza di base
\[
R_B = R_1 || R_2 = 8.70 \pm 0.07 \; \si{k\ohm}
\]
e i valori delle tensioni di alimentazione continue misurate con il multimetro
\begin{align*}
V_{CC} &= 4.99 \pm 0.03 \si{\V} \\
V_{EE} &= -4.99 \pm 0.03 \si{\V}
\end{align*}
\section{Caratterizzazione del punto di lavoro del transistor}
\subsection{Misura delle componenti quiescenti}
Con il multimetro digitale abbiamo misurato
\begin{align*}
V_{BE}^Q &= 630 \pm 4 \; \si{m\V} \\
V_{CE}^Q &= 3.67 \pm 0.03 \; \si{\V} \\
I_C^Q &= \frac{\Delta V_{R_C}}{R_C} = 1.134 \pm 0.011 \; \si{m\A} \\
\end{align*}

Prendendo come riferimento (arbitrario) il valore per la tensione di soglia
della giunzione BE $V_\gamma = 0.65 \pm 0.05 \; \si{\V}$ e come valore atteso
per la tensione al terminale di base del transistor
$\ds V\ped{B, exp} = \frac{V_{CC}}{1 + R_1/R_2}$, ci aspettiamo di trovare
\begin{align*}
V\ped{BE, exp}^Q &\approx V_\gamma = 0.6 \pm 0.1 \; \si{\V} \\
I\ped{C, exp}^Q &= \frac{V_B - V_{BE}^Q}{R_E + R_B/h_{FE}} =
1.09 \pm 0.05 \si{\m\A} \\
V\ped{CE, exp}^Q &= V_{CC} - I_C^Q(R_C + R_E) = 3.9 \pm 0.2 \; \si{\V}  
\end{align*}

\subsection{Tensioni ai terminali del BJT}
Con il multimetro digitale abbiamo misurato rispetto a $V_{EE}$
\begin{align*}
V_E &= 566 \pm 3 \; \si{m\V} \\
V_B &= 1.196 \pm 0.006 \; \si{\V} \\
V_C &= 4.23 \pm 0.03 \; \si{V} \\
\end{align*}

mentre rispetto a $GND$:
\begin{align*}
V_E &= -773 \pm 4 \; \si{m\V} \\
V_B &= -3.76 \pm 0.03 \; \si{\V} \\
V_C &= -4.39 \pm 0.03 \; \si{V} \\
\end{align*}

Come valori attesi otteniamo
\begin{align*}
V\ped{E, exp} &= R_E I_E \approx R_E I\ped{C, exp}^Q = 0.54 \pm 0.2 \; \si{\V} \\
V\ped{B, exp} &= \frac{V_{CC}}{1 + R_1/R_2} = 1.24 \pm 0.13 \; \si{\V} \\
V\ped{C, exp} &= R_C I\ped{C, exp}^Q = 5.5 \pm 0.2 \; \si{V} \\
\end{align*}
\subsection{Rigidità del partitore di tensione}
Possiamo ricavare le intensità di corrente che scorrono per le resistenze
di base a partire dalle misure precedenti
\begin{align*}
I_{R_1} = \frac{V_{CC} - V_B}{R_1} = 124.4 \pm 1.2 \; \si{\micro\A} \qquad
I_{R_2} = \frac{V_B}{R_2} = 120.4 \pm 1.3 \; \si{\micro\A} 
\end{align*}
da cui ricaviamo una stima della corrente di base
\[
I_B^Q = I_{R_1} - I_{R_2} =  4.0 \pm 1.8 \; \si{\micro\A}
\]

Per condizione di partitore di tensione ``stiff'' intendiamo:
\begin{equation}
I_B^Q \ll I_P = \frac{V_B^Q - V_{EE}}{R_B}
\end{equation}
dove abbiamo chiamato $I_P$ la corrente che approssimativamente scorre nel
partitore $R_1 + R_2$.
E, dal calcolo esplicito con i valori misurati, risulta abbastanza ben
verificata
\[
I_P = 143 \pm 5 \; \si{\micro\A} > 30 \cdot I_B^Q
.\] 


Come ulteriore conferma possiamo vedere la stessa condizione come 
$I_{R_1} \sim I_{R_2} > 10 I_{B}$ o, in termini di resistenze
$R_B \ll h_{fe} R_E$ che sono entrambe soddisfatte.

Possiamo anche dare una stima del guadagno in corrente continua del transistor
\[
\beta_F = h_{FE} = \frac{I_C}{I_B} = 2.8 \pm 1.3 \times 10^{2}  
\]

\section{Risposta a segnali sinusoidali}

\subsection{Inversione di fase del segnale in uscita}
La nostra stima della frequenza per cui $A_v$(dB) = -3 dB \`e
\[
f_{1A} = 7336 \pm 6 \; \si{\Hz}
\]

\subsection{Guadagno per piccoli segnali in ingresso}
Dal fit a bassa frequenza ($f\ll f_1$) otteniamo
\[
A_1(\mathrm{dB}) = \left(-17.91 \pm 0.18\right)\times 10^{-3} \;\;\;
\chi^2 = 243 \;\;\; d.o.f. = 873
\]

Ad alta frequenza ($f \gg f_1$) la retta di best-fit al plot di Bode in 
ampiezza ha i seguenti parametri:
\[
\mathrm{intercetta} = 75.928 \pm 0.008 \;\;\;\mathrm{pendenza} = -19.6747 \pm 
0.0016 \;\;\;\mathrm{correlazione} 
= -0.997 \;\;\; \chi^2 = 1647 \;\;\; d.o.f. = 1746
\]
Dall'intersezione delle due rette stimiamo per la frequenza di taglio il valore
\[
f_{1B} = 7246 \pm 8 \; \si{Hz}
\]

\begin{figure}[htb]
\centering
\includegraphics[scale=0.35]{Alin200mV}
\caption{Risposta del circuito ad un segnale sinusoidale di ampiezza
$\SI{200}{m\V}$ e $f = \SI{1}{k\Hz}$ in ingresso. Quando l'amplificatore
è in pieno regime attivo. \label{fig: Alin}}
\end{figure}

\subsection{Linearità del circuito amplificatore}
Quando la tensione in ingresso è abbastanza alta da condurre la giunzione
BC in polarizzazione diretta il transistor entra in regime di saturazione,
dove non è più valida la relazione lineare tra le intensità di corrente di
base e collettore: per cui si osserva una distorsione del segnale in uscita.

In particolare il segnale in uscita risulta distorto o ``tosato'' in basso,
in maniera asimmetrica in corrispondenza della semionda positiva in ingresso
(per la natura invertente dell'amplificatore). Se infatti $V_{BC}$ aumenta
fino a valori prossimi a $V_\gamma$ (o perlomeno abbastanza alti da non
garantire che la giunzione BC rimanga in polarizzazione inversa) deve
diminuire $V_{CE} = V_C - V_B + V_B - V_E = -V_{BC} + V_{CE}$. Dunque ci
spostiamo a sinistra del punto di lavoro fino ad arrivare al regime di
saturazione.
Il che spiega come mai l'effetto di ``clipping'' sia più marcato durante
il semiperiodo positivo dell'onda in ingresso.

\begin{figure}[htb]
\centering
\includegraphics[scale=0.35]{Asat400mV}
\caption{Risposta del circuito ad un segnale sinusoidale di ampiezza
$\SI{450}{m\V}$ e $f = \SI{1}{k\Hz}$ in ingresso. Quando l'amplificatore
è vicino al regime di saturazione. \label{fig: Asat}}
\end{figure}


\subsection{Clipping del segnale in uscita}
Aumentando ancora l'ampiezza del segnale alternato in ingresso $v_{in}$ fino
a $\sim \SI{0.7}{\V}$, anche la parte alta del segnale in uscita è tagliata.
In questo caso è la giunzione BE a cambiare polarizzazione, per cui quando
entrambe le giunzioni sono inversamente polarizzate il transistor entra in
regime di interdizione. Le uniche correnti che attraversano il BJT sono quelle
di saturazione inversa, per cui in buona approssimazione si comporta come un
circuito aperto, come si vede dal grafico delle correnti di collettore.

\begin{figure}[htb]
\centering
\includegraphics[scale=0.35]{Aint700mV}
\caption{Risposta del circuito ad un segnale sinusoidale di ampiezza
$\SI{700}{m\V}$ e $f = \SI{1}{k\Hz}$ in ingresso. Quando l'amplificatore
è vicino al regime di interdizione. \label{fig: Aint}}
\end{figure}

\section{Impedenze in ingresso e uscita}
Il fronte del segnale di uscita ha un tempo di salita, misurato con i cursori, 
di 
\[
t_r = 47 \pm 2 \; \si{\micro\second}
\]
da cui 
\[
f_1 = \ln(9) R_1 C_1 \approx \frac{2.2}{2\pi t_r} = 7.4 \pm 0.3 \; \si{k\Hz}
\]

\subsection{Impedenza di ingresso}
Come valore atteso per l'impedenza in ingresso al circuito abbiamo:
\[
Z\ped{in}(\omega) = h_{ie} + h_{fe}Z_E(\omega) \; \lvert\rvert \; R_B =
\left(\frac{1}{h_{ie} + h_{fe}Z_E} + \frac{1}{R_1} + \frac{1}{R_2}\right)^{-1}
\]

dove abbiamo indicato con $Z_E(\omega)$ l'impedenza del ramo di emettitore,
che nel nostro circuito vale $Z_E = R_E$; meno che nel punto 5, dove in
parallelo a $R_E$ si aggiunge un passa alto costruito con $C_E + R\ped{es}$,
per cui vale $Z_E(\omega) = R_E || \left(R\ped{es} + \frac{1}{j \omega C_E}
\right)$.

A bassa frequenza ($f \ll f_1$) il termine costante è trascurabile, per cui
\[
Z\ped{in}(f) \approx -jR_1 \frac{f_1}{f}
\]
Poiché l'impedenza del condensatore $Z_{C_1} \to \infty$ per $f \to 0$
il filtro si comporta come un circuito aperto.

Ad alta frequenza ($f \gg f_1$) è il termine costante a dominare, quindi
\[
Z\ped{in} \approx R
\]
cioè, nel limite opposto ($Z_{C_1} \to 0$ per $f \to \infty$) il
condensatore si comporta come un corto-circuito, quindi il filtro ha
impedenza puramente reale.

Alla frequenza di taglio vale
\[
Z\ped{in} = R_1 (1 - j)
.\]

\subsection{Impedenza di uscita}
Mentre come impedenza in uscita dal circuito ci aspettiamo di trovare
\[
Z\ped{out} = R_C
.\]

(Qui \`e richiesto che valutiate l'~amplificazione di centro-banda e la 
frequenza di taglio nel 
caso in cui il carico sia rispettivamente 100 e 10 k$\Omega$)
\[
\begin{array}{rl}
R_L=100 \,k\Omega & \implies A_1 = 0.98 \;\;\; f_1 = 7450 \\
R_L=10 \,k\Omega & \implies A_1 = 0.83\;\;\; f_1 = 8761 \\
\end{array}
\]

%=======================
\section{Risposta in frequenza}

\subsection{Network Analyzer}
\begin{figure}[htb]
\centering
\includegraphics[scale=0.35]{1-10Mnet}
\caption{Plot di Bode ottenuto dallo scan con Network tra $\SI{1}{\Hz}$ e 
$\SI{10}{M\Hz}$ con un segnale sinusoidale in ingresso di ampiezza
$\SI{200}{m\V}$. \label{fig: bodeplot}}
\end{figure}

\subsection{Stima delle frequenze di taglio}
Dalla fit con la funzione di trasferimento del passa basso risulta:
\begin{figure}[htb]
\centering
%\includegraphics[scale=0.4]{passa_basso}
\caption{Fit con il modello della funzione di trasferimento per il filtro passa basso}
\end{figure}
Il valore della frequenza di taglio vale invece:
\begin{align*}
f_1 = 7.76 \pm 0.01 \; \si{k\Hz}\\
\end{align*}
che è compatibile con i valori attesi.

Il guadagno a centro banda vale:
\begin{align*}
A_1 = (-23 \pm 61) \times 10^{-3} \; \si{dB}
\end{align*}

\section{Aumento del guadagno con passa-alto all'emettitore}
\begin{align*}
R_2 = 1.98 \pm 0.02 \; \si{k\ohm} \quad C_1 = 97.6 \pm 3.9 \; \si{n\F} \quad
f_1 = 821 \pm 41 \; \si{\Hz}
\end{align*}

\subsection{Guadagno a 10 kHz con condensatore $C_E$}
Dal fit con modello la funzione di trasferimento di un filtro passa alto risulta:
\begin{figure}[htb]
\centering
%\includegraphics[scale=0.4]{passa_alto}
\caption{Fit con il modello della funzione di trasferimento per il filtro passa alto}
\end{figure}
Il valore della frequenza di taglio ricavata dal fit vale:
\begin{align*}
f_2 = 821.3 \pm 0.2 \; \si{Hz}
\end{align*}
Il guadagno a centro banda vale:
\begin{align*}
A_2 = (-25 \pm 61) \times 10^{-3} \; \si{dB}
\end{align*}
\subsection{Confronto con il guadagno atteso}
La nostra stima dell'amplificazione di centro-banda e delle frequenze di 
taglio (per cui il guadagno si riduce di 3 dB rispetto a centro-banda) \`e
\[
A(\mathrm{dB}) = -6.505 \pm 0.006 \;\;\; f_{L} = 380 \pm 3 \si{\Hz} \;\;\;
f_{H} = 16.29 \pm 0.16 \si{k\Hz}
\]

\iffalse
\subsection*{10.b Fit della funzione di trasferimento}
Utilizzando come modello la funzione di trasferimento per il passa banda si ottiene:

\begin{figure}[htb]
\centering
\includegraphics[scale=0.35]{passa_banda}
\caption{Fit con il modello della funzione di trasferimento per il filtro
passa banda}
\end{figure}


Dal fit del plot di Bode in ampiezza si ha
\[
A(\mathrm{dB}) = \ldots \pm \ldots \;\;\;f_{L} = \ldots\pm \ldots\;\;\;f_{H} = 
\ldots\pm 
\ldots\;\;\;\chi^2 = \ldots\;\;\; d.o.f.= \ldots
\]

\subsection*{10.c Differenze}
A differenza dei circuiti RC studiati prima, non possiamo considerare
indipendenti i sotto-circuiti che compongono il passa-banda; infatti il
comportamento reale del circuito è sensibilmente diverso da quanto previsto in 
approssimazione di stadi indipendenti.

In particolare a centro banda (i.e. nell'intervallo di frequenza
$f_2 \leq f \leq f_1$) l'attenuazione non è più in ottima approssimazione
unitaria, ma è minore di $A\ped{max}(f) \approx \SI{-6}{\dB/dec}$.

Le frequenze di taglio misurate $f_L$ e $f_H$ non sono compatibili con quelle
ottenute separatamente nell'analisi dei singoli circuiti. Più precisamente
la frequenza più bassa (del passa alto) è pressoché dimezzata
$f_L > f_2$, mentre la frequenza più alta (del passa basso) è più che
raddoppiata $f_H > f_1$.

D'altra parte, una ragionevole richiesta per assicurare l'indipendenza dei due
circuiti collegati in serie è che si abbia
$\abs{Z\ped{out, 1}} \ll \abs{Z\ped{in,2}}$ ad ogni frequenza (e 
indipendentemente da questa). Riportiamo le impedenze in questione:
\[
\abs{Z\ped{out, 1}} = \abs{\frac{R_1}{1 + j \omega R_1 C_1}}^2 = 
\frac{R_1^2}{1 + \omega^2 R_1^2 C_1^2}
\qquad
\abs{Z\ped{in, 2}}^2 = \abs{\frac{1 + j \omega R_2 C_2}{j\omega 
C_2}}^2 = \frac{1 + \omega^2 R_2^2 C_2^2}{\omega^2 C_2^2}
\]
Ora $\abs{Z\ped{out, 1}} \leq 1/(\omega C_1)$ con $\abs{Z\ped{out, 
1}} \sim 1/(\omega C_1)$ per $f \gg f_1 $ e $\abs{Z\ped{in, 2}} 
\geq 1/(\omega C_2)$ con $\abs{Z\ped{out, 1}} \sim 1/(\omega C_2) 
$ per $ f \ll f_2 $. Quindi per poter considerare indipendenti i due circuiti
è sicuramente una buona idea imporre la condizione
\[
\abs{Z\ped{out, 1}} \leq \frac{1}{\omega C_1} \ll \frac{1}{\omega C_2} \leq 
\abs{Z\ped{in, 2}} \implies C_2 \ll C_1.
\]
Mentre per i valori di capacità scelti vale la condizione opposta
$C_2 \approx 10 \cdot C_1$.

\subsection*{10.d Dipendenza dai valori delle resistenze}
Se indichiamo con $A_1(f)$ e $A_2(f)$ le attenuazioni del passa-basso e del
passa-alto, l'attenuazione attesa in uscita dai due circuiti collegati in
cascata è
\begin{equation}\label{eq: bpfgain}
A = \left(\frac{R_1}{R_2} + \frac{1}{A_1 A_2}\right)^{-1} = 
\frac{A_1 A_2}{A_1 A_2 \frac{R_1}{R_2} + 1} 
\end{equation}
Nel nostro caso vale $R_1 = R_2$ (entro l'incertezza) per cui come
attenuazione di centro banda, dove avevamo $A_1 \approx A_2 \approx 1$, ci
aspettiamo di avere $A\ped{cb} = \frac{1}{2}$.
Questo è compatibile con il valore che abbiamo misurato (prima in dB)
$A\ped{cb} = 0.4702 \pm 0.0004 \approx \frac{1}{2}$

Per avere una risposta in frequenza del circuito complessivo il più possibile
uguale al prodotto delle funzioni di trasferimento dei due sotto-circuiti
avremmo dovuto scegliere $R_1 \ll R_2$ ($Z\ped{out, 1} \ll Z\ped{in, 2}$.
Infatti l'attenuazione attesa a centro banda vista in \eqref{eq: bpfgain}
sotto queste ipotesi diventa $A\ped{cb} \approx A_1 A_2 \approx 1$.
\subsection*{10.e Andamento della fase}
Idealmente, se la funzione di trasferimento complessiva $T(\omega)$ per il
passa banda è il prodotto delle funzioni di trasferimento dei due circuiti in
cascata:
\begin{align*}
T_1(\omega) = -\frac{1}{1 + j \omega/\omega_1} \qquad
T_2(\omega) = \frac{1}{1 - j \omega_2/\omega}
\end{align*}
ci aspettiamo (per le regole di moltiplicazione sui complessi) che lo
sfasamento totale in uscita sia pari alla somma degli sfasamenti prodotti dai
singoli sotto-circuiti:
\[
T(\omega) = T_1(\omega) T_2(\omega) =
\abs{T_1} e^{i (\omega t + \phi_1)} \abs{T_2} e^{i (\omega t + \phi_2)} =
\abs{T_1} \abs{T_2} e^{i (\omega t + \phi_1 + \phi_2)} =
\abs{T_1} \abs{T_2} e^{i (\omega t + \phi)}
\]
per cui $\phi = \phi_1 + \phi_2 =
\tan^{-1} \left( \dfrac{\Im{\{T_1(\omega)\}}}{\Re{\{T_1(\omega)\}}} \right) +
\tan^{-1} \left( \dfrac{\Im{\{T_2(\omega)\}}}{\Re{\{T_2(\omega)\}}} \right)$
che corrispondono rispettivamente a
\begin{align*}
\phi_1(\omega) = \arctan - \frac{\omega}{\omega_1} \qquad
\phi_2(\omega) = \arctan \frac{\omega_2}{\omega}
\end{align*}

Effettivamente le misure di sfasamento in uscita dal passa-banda risultano
in accordo con l'andamento atteso
\begin{equation}
\phi_2 + \phi_1 = \phi(f) = \arctan{\frac{f_2}{f}} - \arctan{\frac{f}{f_1}}
\end{equation}
\begin{figure}[htb]
\centering
\includegraphics[scale=0.7]{bpfphase}
\caption{Grafico dello sfasamento misurato per il filtro passa-banda al
variare della frequenza in scala semilogaritmica.}
\end{figure}
almeno fino a frequenze dell'ordine di $10^5 \; \si{\Hz}$ dove i punti
iniziano a deviare dal modello man mano che ci si avvicina alla banda
passante dell'AD2 $(\sim 9 \; \si{M\Hz})$. Questo può essere dovuto alle
capacità parassite tra i fili, i componenti e la basetta che ad alta
frequenza non sono trascurabili, a differenza di quanto presuppone il nostro
modello.
\fi

\section*{Conclusioni e commenti finali}
Si è riusciti a realizzare dei filtri RC passivi del primo ordine
(o ``a un polo'') e ad apprezzarne il differente comportamento in vari
regimi, quando usati separatamente, collegati in cascata e connessi a
carichi resistivi di diverso valore.

\section*{Dichiarazione}
I firmatari di questa relazione dichiarano che il contenuto della relazione \`e 
originale, con misure effettuate dai membri del gruppo, e che tutti i firmatari 
hanno contribuito alla elaborazione della relazione stessa.

\end{document}
