\documentclass[10pt, a4paper, italian]{article}
\input{../../latex/preamble}
\input{../../latex/math}
\geometry{left=2cm, right=2cm, top=2cm, bottom=2cm}

% indexes subsections with letters, sections with numbers (1.a, 1.b, ...)
\renewcommand{\thesubsection}{\thesection.\alph{subsection}}

% lets graphicx know path where figures to be included are found
\graphicspath{{../figs/}}

\author{Gruppo 1.AC \\ Matteo Rossi, Bernardo Tomelleri}
\title{Es09: Misura della velocità del suono}
\begin{document}
\date{\today}
\maketitle

\setcounter{section}{0}

\section*{Misura componenti dei circuiti}
\begin{table}[htbp]
\centering
\begin{tabular}{ccc|ccc}
\toprule
Resistenze $[\si{k\ohm}]$ & $R$ & $\sigma R$ & Resistenze $[\si{k\ohm}]$ & $R$ &
$\sigma R$ \\
\midrule
\midrule
$R_1$	  	& 9.95 	& 0.08		& $R_1$ & 9.98	& 0.08 \\
\bottomrule
\end{tabular}
\caption{Valori di resistenza misurate con il multimetro dei componenti dei
due circuiti studiati. \label{tab: rcmes_B}}
\end{table}

Riportiamo per completezza anche il valore della tensione di alimentazione
continua per il sensore a ultrasuoni misurata con il multimetro.
\[
V_{CC} = 4.99 \pm 0.03 \si{\V}
\]

\subsection*{Nota sul metodo di fit}
Per determinare i parametri ottimali e le rispettive covarianze si \`e
implementato in \verb+Python+ un algoritmo di fit basato sui minimi quadrati
mediante la funzione \emph{curve\_fit} della libreria \texttt{SciPy}.

%=======================
\section{Misura velocità del suono}
Come primo passo per realizzare la misura, si è costruito il circuito indicato in figura sotto.

\begin{figure}[htbp]
    \centering
	\includegraphics[scale=1]{schm}
    \caption{Schematica del circuito per la misurazione della velocità del suono e della temperatura
    \label{schm: mesctrl}}
\end{figure}

\subsection{Analisi del funzionamento del circuito}
Il componente principale è il Sensore HC-SR04, un sensore ad ultrasuoni che se utilizzato correttamente fornisce il tempo di viaggio (andata e ritorno) di un'onda sonora ad alta frequenza, sono udibile dall'uomo.
Questo componente deve essere alimentato da una tensione di 5 V; se al pin \verb+TRIG+ viene inviato un segnale di trigger (che deve soddisfare le condizioni di durata specifiche, vale a dire che l'impulso deve avere una durata superiore ai $10 \mu S$) il componente genera un segnale continuo alto nel pin \verb+ECHO+ e un'onda sonora che si propaga finché non incontra un ostacolo, per cui tornerà indietro e verrà captato dal sensore piezoelettrico,; a questo punto, il segnale alto presente nel pin \verb+ECHO+ tornerà ad essere basso. Controllando quindi quest'ultimo pin tramite l'oscilloscopio sarà possibile individuare un segnale della stessa durata che impiega l'onda sonora a propagarsi, riflettersi su un oggetto, e ritornare indietro.
\begin{figure}[H]
    \centering
	\includegraphics[scale=0.4]{echo}
    \caption{Segnali di Trigger (in giallo, su CH1) ed Echo (in blu, su CH2) per una misura con bersaglio a 15 cm di distanza}
\end{figure}
Inoltre è stato montato anche un sensore di temperatura tramite un partitore di tensione con una resistenza da $10 k\ohm$ e un termistore con $R_0 =10 k\ohm$, e misurando la tensione presente tra i due.
Conoscendo quindi la distanza D del sensore dell'oggetto, è possibile ricavare la velocità del suono come
\begin{equation}
v= \frac{2 D}{\Delta T}
\end{equation}
\subsection{Misura}
Si è proceduto con la misura di tempi di viaggio per diversi valori di distanza sensore oggetto. Successivamente abbiamo fatto un plot con python della distanza in funzione del tempo, facendo poi un fit lineare e ricavandone il coefficiente angolare e l'intercetta; In particolare si sono divise le situazioni di distanze corte (tra 15 e 25 cm) e distanze più lunghe (sopra i 25 cm).
\begin{table}[H]
\centering
\begin{tabular}{cc}
Travel Time [ms] & Distance [cm] \\
0.86 & 15   \\
0.92 & 16   \\
0.98 & 17   \\
1.03 & 18  \\
1.10 & 19   \\
1.15 & 20   \\
1.21 & 21   \\
1.27 & 22   \\
1.32 & 23  \\
1.39 & 24 
\end{tabular}
\caption{Tabella con distanze e tempi di viaggio impiegati nell'esperimento delle distanze brevi}
\end{table}
\begin{table}[H]
\centering
	\begin{tabular}{cc}
	\hline
	Travel Time [ms] & Travel Space [mm] \\ \hline
	1.44                              & 504                                  \\
	1.50                              & 524                                  \\
	1.56                              & 540                                  \\
	1.60                              & 564                                  \\
	1.65                              & 582                                  \\
	1.71                              & 600                                  \\
	1.74                              & 622                                  \\
	1.83                              & 644                                  \\
	1.88                              & 664                                  \\
	1.94                              & 682                                  \\
	2.00                              & 700                                  \\
	2.05                              & 720                                  \\
	2.11                              & 740                                  \\
	2.18                              & 756                                  \\
	2.23                              & 784                                  \\
	2.29                              & 800                                  \\
	2.33                              & 820                                  \\
	2.41                              & 840                                  \\
	2.47                              & 860                                  \\
	2.51                              & 880                                 
	\end{tabular}
	\caption{Tabella con spazi percorsi e tempi di viaggio impiegati nell'esperimento delle distanze lunghe}
\end{table}
\begin{figure}[H]
    \centering
	\includegraphics[scale=0.3]{2}
    \caption{Distanze corte in funzione del tempo}
\end{figure}
\begin{figure}[H]
    \centering
	\includegraphics[scale=0.7]{railtime}
    \caption{Distanze lunghe in funzione del tempo}
\end{figure}
\begin{table}[H]
\centering
\begin{tabular}{cc|c}
\toprule
$V_s [\frac{m}{s}]$& $\sigma V_s$ & $Temperatura [Celsius]$ \\
\midrule
348.0 & 1.8 & 20\\
347.3 & 3.0 & 19\\
\bottomrule
\end{tabular}
\caption{Risultati del fit lineare per la velocità del suono}
\end{table}
In entrambi i casi abbiamo ottenuto anche un'intercetta che fosse compatibile con 0:
\begin{table}[H]
\centering
\begin{tabular}{cc}
\toprule
$q [\frac{m}{s}]$& $\sigma V_s$ \\
\midrule
-0.3 & 6.1 \\
-0.4 & 1.0 \\
\bottomrule
\end{tabular}
\caption{Risultati del fit lineare per la velocità del suono}
\end{table}
Nel primo caso (distanze brevi), per misurare correttamente la distanza, senza esagerare con l'errore associato, è stata ricavata la posizione del cristallo piezoelettrico inserendo un piccolo oggetto in carta (in modo da non danneggiare nulla) all'interno dei due occhi del sensore, da cui abbiamo ricavato che ci sono circa 5 mm di distanza tra il cristallo e la rete di protezione esterna. Per cui è stato possibile diminuire l'incertezza sulla distanza fino a 2 millimetri. Nell'altro esperimento invece è stata presa la distanza a partire dal punto medio dell'occhio, utilizzando come incertezza la metà dello spessore. Per quanto riguarda i tempi invece sono stati presi alla stessa maniera, utilizzando il metodo dei cursori sull'asse x e misurando la durata dell'impulso in \verb+ECHO+. I 2 esperimenti sono stati eseguiti all'interno di 2 case diverse in città diverse, quindi con condizioni di umidità relative diverse, nonostante ciò sono risultate perfettamente compatibili tra di loro, e con la velocità aspettata di $343 \frac{m}{s}$ a $20 \degree C$ entro le 3 barre di errore massime.
\subsection{jitter}
Un fenomeno a cui va data particolare attenzione è il ritardo con cui il segnale echo ritorna a essere basso dopo che il sensore ha ricevuto l'onda. Questo ritardo, denominato jitter, è dovuto al fatto che il sensore salta il primo fronte d'onda perché questo a sua volta non genera un livello di tensione sufficiente da far scattare i circuiti integrati. Cercando su internet per la schematica completa del sensore notiamo la presenza di 3 circuiti principali, denominati U1, U2 e U3: mentre U1 e U3 servono solo per il controllo dei segnali di echo e della generazione dell'onda sonora, U2 è impiegato nel riconoscere il segnale acustico.
Infatti questo circuito è composto da vari componenti tra cui un filtro passa banda e un amplificatore. Collegandosi direttamente al pin 10 dell'U2 è possibile vedere le onde a 40 kHz isolate e amplificate dal circuito (ammesso che siano state captate).
\begin{figure}[H]
    \centering
	\includegraphics[scale=0.4]{jitter2}
    \caption{Segnale in uscita dal pin 10 del circuito U2 su CH2, segnale in uscita da echo su CH1}
\end{figure}
Misurando il ritardo con i cursori si arriva a concludere che, se presente, inciderà sul travel time di 25 $\mu s$ che è proprio il periodo di un'onda a 40 kHz.
%=======================
\section{Dipendenza della velocità dalla temperatura}
Sappiamo che la velocità del suono attraverso l'aria non è costante ma varia, principalmente a causa della temperatura e dell'umidità.
Nel nostro caso proveremo a misurare questo cambiamento tramite un sensore detto termistore che varia la sua resistenza in funzione della temperatura.
Tramite un partitore di tensione possiamo misurare il potenziale compreso tra il una resistenza da 10 $k\ohm$ e il termistore per poi ricavarne il valore.
\begin{equation}
R_t=\frac{R_1V_2}{V_{cc}-V_2}
\end{equation}
Dove $V_2$ è la tensione misurata da CH1.
A quel punto sappiamo che la temperatura e la resistenza sono legati dall'equazione:
\begin{equation}
\frac{1}{T}= \frac{1}{T_0} + \frac{ln(\frac{R}{R_0})}{B}
\end{equation}
Possiamo riscriverla come:
\begin{equation}
T=\frac{T_0 B}{B+T_0 \ln{\frac{R}{R_0}}}
\end{equation}
Inoltre la velocità del suono e la temperatura sono legati da:
\begin{equation}
V_s=v_0\sqrt{\frac{T+273.15}{273.15}}
\end{equation}
Dove T è la temperatura espressa in Celsius e $v_0$ la velocità del suono a 0 gradi Celsius.
\subsection{Misura}
Come prima, abbiamo misurato la durata dell'impulso ECHO a distanza fissa di $252 \pm 2 \; mm$ (anche in questo caso si è diminuita l'incertezza prendendo come punto di partenza delle onde 5 mm dalla fine dell'occhio del sensore) a diverse temperature, lasciando il circuito montato e fisso sempre nello stesso punto.
Per quanto riguarda i parametri B e $R_0$ siamo andati a ricercarli nel datasheet del termistore, e per il nostro interesse risultano essere $B=3950 K \pm 1 \percent$ e $R_0 = 10 k\ohm \pm 1 \percent$; successivamente si è provato ad eseguire una lettura per la misura della temperatura piazzando il circuito a fianco di un termostato per verificare che il circuito funzionasse: dai risultati abbiamo ottenuto $V_2=2.81 \pm 0.02 V$ la cui temperatura si ricava essere $19.4 \pm 0.4 \degree C$ quando il termostato segnava $19.5  \degree C$ (il quale aveva una risoluzione di 1 decimo di grado), quindi risulta compatibile.
Nonostante risulti semplice lasciare il circuito montato e funzionante, siamo riusciti a misurare un intervallo di solo $5 \degree C$ compresi tra i 15 e i 20; che sono stati comunque sufficienti per ricavare $v_0$. Abbiamo quindi preso le misure dei tempi tramite cursori sulle x misurando la durata dell'impulso di echo e dei valori di $V_2$ tramite la funzione VOLTMETER di Waveforms.
\begin{table}[H]
\centering
\begin{tabular}{ccc}
\toprule
Time [ms] & $V_2$ & Temperatura sul termostato \\
\midrule
1.49 & 3.11 & 15 \\
1.49 & 3.03 & 16 \\
1.48 & 2.98 & 17 \\
1.48 & 2.93 & 18 \\
1.47 & 2.88 & 19 \\
1.47 & 2.83 & 20
\end{tabular}
\caption{Tabella dei tempi di percorrenza in funzione della temperatura}
\end{table}
A questo punto abbiamo combinato le equazioni (2) e (4) per ricavare i dati di velocità e temperatura e le incertezze propagandole dalle medesime funzioni. In seguito si è condotto un fit con modello l'eq. (5) per ricavare $v_0$.
\begin{figure}[H]
    \centering
	\includegraphics[scale=0.3]{Temperature}
    \caption{Fit e residui per la velocità del suono in funzione della temperatura}
\end{figure}
Da qui abbiamo ottenuto che $v_0 =331 \pm 1 \; m/s$ che risulta essere perfettamente compatibile con il valore atteso. Ovviamente bisogna stare attenti a riportare le misure in uscita dall'equazione (4) in Celsius, altrimenti è sufficiente rivedere l'equazione (5).
%=======================
\section*{Conclusioni e commenti finali}
Si è riusciti a dare una misura ragionevole della velocità del suono in aria
e si è riusciti ad apprezzare la sua dipendenza dalla temperatura ambientale
con un semplice sensore ad ultrasuoni ed un termistore.

%=======================
\section*{Dichiarazione}
I firmatari di questa relazione dichiarano che il contenuto della relazione \`e
originale, con misure effettuate dai membri del gruppo, e che tutti i firmatari
hanno contribuito alla elaborazione della relazione stessa.


\end{document}
