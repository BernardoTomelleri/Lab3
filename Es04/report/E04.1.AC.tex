\documentclass[10pt,a4paper]{article}
\input{../../latex/preamble}
\input{../../latex/math}
\geometry{left=2cm, right=2cm, top=2cm, bottom=2cm}

% indexes subsections with letters, sections with numbers (1.a, 1.b, ...)
\renewcommand{\thesubsection}{\thesection.\alph{subsection}}

% lets graphicx know path where figures to be included are found
\graphicspath{{../figs/}}

\author{Gruppo 1.AC \\ Matteo Rossi, Bernardo Tomelleri}
\title{Es04A: Amplificatori operazionali e filtri attivi}
\begin{document}
\date{\today}
\maketitle

\setcounter{section}{0}

\section*{Misura componenti del circuito}
\begin{table}[ht]
\centering
\begin{tabular}{cccccc}
\toprule
Resistenze $[\si{\ohm}]$ & $R$ & $\sigma R$ & Capacità $[\si{n\F}]$ & $C$ &
$\sigma C$ \\
\midrule
\midrule
$R_1$	  & 998 	& 8 	 & $C$ & 50			 & 2 \\
$R_2^a$	  & 7.04	& 0.06 	 & & &	\\
$R_2^f$	  & 9.85 k	& 0.08 k & & &	\\
$R_S$	  & 998		& 8		 & & &	\\
\bottomrule     
\end{tabular}
\caption{Valori di resistenza e capacità misurate per i componenti dei
circuiti studiati. \label{tab: rcmes_M}}

\begin{tabular}{cccccc}
\toprule
Resistenze $[\si{\ohm}]$ & $R$ & $\sigma R$ & Capacità $[\si{n\F}]$ & $C$ &
$\sigma C$ \\
\midrule
\midrule
$R_1$	  & 993 	& 8 	 & $C$ & 48			 & 2 \\
$R_2^a$	  & 5.09 k	& 0.04 k 	 & & &	\\
$R_2^f$	  & 9.94 k		& 0.08 k & 		& 		 &	\\
$R_3$	  & 993		& 8		 &				&				 &		\\
$R_S$	  & 992		& 8		 &				&				 &		\\
\bottomrule     
\end{tabular}
\caption{Valori di resistenza e capacità misurate per i componenti dei
circuiti studiati. \label{tab: rcmes_B}}
\end{table}
Riportiamo per completezza anche il valore calcolato della resistenza di base
\[
R_B = R_1 || R_2 = 8.70 \pm 0.07 \; \si{k\ohm}
\]
e i valori delle tensioni di alimentazione continue misurate con il multimetro
\begin{align*}
V_{CC} &= 4.99 \pm 0.03 \si{\V} \\
V_{EE} &= -4.99 \pm 0.03 \si{\V}
\end{align*}

\section{Circuito amplificatore invertente}
\subsection{Progettazione del circuito}
Scegliamo di costruire un amplificatore invertente a partire da un op-amp
TL081CP con impedenza in ingresso maggiore o uguale a $\SI{1}{k\ohm}$ e guadagno
$A\ped{v, atteso} = - \dfrac{R_2}{R_1}$ compreso (in valore assoluto) tra $5$
e $10$ come quello in figura \ref{fig: ampschm}

\begin{figure}[ht]
    \centering
    \begin{circuitikz}
        \draw
		(3,0) node[op amp] (opamp) {}
		(opamp.+) to[short] (1.8, -2) node[eground]{}
		(opamp.-) to[R=$ R_1 $, *-] (-0.8,0.5)
		(opamp.out) to (5,0) node[ocirc, label=$ v\ped{out} $]{}
		(opamp.up) --++(0,0.5) node[vcc]{$V_{CC} =$ 5\,\textnormal{V}}
		(opamp.down) --++(0,-0.5) node[vee]{$V_{EE} =$ -5\,\textnormal{V}};
		\draw
		(1.8, 0.5) to [short] (1.8, 2.7)
		to [R=$ R_2 $] (4.5, 2.7)
		to [short, -*] (4.5, 0);
		\draw
		(-0.8, -2) node[eground] {}
		to[sV, v=$ v\ped{in} $] (-0.8, 0.5);
		\draw
		(5, -1) --++ (0, 0.45) node[vcc] {}
		--++ (0, -1.4) node[vee] {};
    \end{circuitikz}
    \caption{Schema di massima dell'amplificatore invertente costruito.
    \label{fig: ampschm}}
\end{figure}

In condizione di op-amp ideale gli ingressi $+, -$ sono dei circuiti aperti,
per cui la stessa corrente scorre attraverso $R_1$ ed $R_2$:
$V_+ = V_- \approx 0 \implies R\ped{in} \approx R_1$, allora per
soddisfare la richiesta $5 \leq A_v \leq 10$ basta imporre
$5 R_1 \leq R_2 \leq 10 R_1$.

Dunque una volta fissata $R_1 = 1 \pm 1\% \; \si{k\ohm}$, dobbiamo avere
$\SI{5}{k\ohm} \leq R_2 \leq \SI{10}{k\ohm}$, di conseguenza scegliamo
$R_2 = 5.1 \pm 1\% \; \si{k\ohm}$, che corrisponde ad un guadagno
di centro banda $A\ped{v, atteso} = 5.1 \pm 2\%$ 

\subsection{Amplificazione di piccoli segnali}
Si è inviato all'ingresso di entrambi i circuiti un segnale sinusoidale di
ampiezza $v\ped{in} = 200 \pm 2 \; \si{m\V}$ ad una frequenza fissata
$5.01 \pm 0.05 \; \si{k\Hz}$.

Dunque abbiamo misurato l'ampiezza del segnale in uscita dal circuito con
$R_2^a = \SI{5.1}{k\ohm}$, che risulta $v\ped{out} = 1022 \pm 8 \; \si{m\V}$,
ottenendo così una stima del guadagno dell'amplificatore
$A_v = \dfrac{v\ped{out}}{v\ped{in}} = 5.11 \pm 0.06 $.

Mentre per il circuito con $R_2^a = \SI{7}{k\ohm}$ si trova
$v\ped{out} = 1411 \pm 8 \; \si{m\V}$, che corrisponde ad un guadagno di
$A_v = \dfrac{v\ped{out}}{v\ped{in}} = 7.06 \pm 0.06$.

\subsection{Misure di guadagno al variare di $v\ped{in}$}
Misurando con l'oscilloscopio l'ampiezza dei segnali in ingresso $v\ped{in}$
e in uscita $v\ped{out}$ dall'amplificatore possiamo ricavare una misura del
guadagno del circuito dal rapporto $A_v = \dfrac{v\ped{out}}{v\ped{in}}$.
\begin{table}[htb]
\centering
\begin{tabular}{cccc}
\toprule
$v\ped{in}(\si{m\V})$ (nom.) & $v\ped{in} \pm \sigma(v\ped{in})$ [mV] & $v\ped{out} \pm \sigma(v\ped{out})$ [V] & $A_v \pm \sigma(A_v)$ \\
\midrule
\midrule
50 & $50.0 \pm 0.4$ & $256 \pm 2 \; \si{m}$ & $5.12 \pm 0.06$ \\
100 & $100.0 \pm 0.8$ & $511 \pm 4 \; \si{m}$ & $5.11 \pm 0.06$ \\
150 & $150.0 \pm 1.2$ & $767 \pm 6$ & $5.11 \pm 0.06$ \\
200 & $200 \pm 1.6$ & $1022 \pm 8$ & $5.11 \pm 0.06$ \\
250 & $250 \pm 2$ & $1278 \pm 11$ & $5.11 \pm 0.06$ \\
300 & $300 \pm 2$ & $1534 \pm 12$ & $5.11 \pm 0.05$ \\
350 & $349 \pm 3$ & $1790 \pm 14$ & $5.13 \pm 0.06$ \\
400 & $399 \pm 3$ & $2046 \pm 16$ & $5.13 \pm 0.06$ \\
450 & $449 \pm 4$ & $2302 \pm 18$ & $5.13 \pm 0.06$ \\
500 & $499 \pm 4$ & $2.56 \pm 0.02$ & $5.13 \pm 0.06$ \\
550 & $549 \pm 4$ & $2.82 \pm 0.02$ & $5.13 \pm 0.06$ \\
600 & $599 \pm 5$ & $3.07 \pm 0.02$ & $5.13 \pm 0.06$ \\
\rule{0pt}{3ex}
700 & $699 \pm 6$ & $3.55 \pm 0.03$ & $5.07 \pm 0.06$ \\
800 & $799 \pm 6$ & $3.82 \pm 0.03$ & $4.78 \pm 0.05$ \\
900 & $899 \pm 7$ & $3.86 \pm 0.03$ & $4.28 \pm 0.05$ \\
1 V & $999 \pm 8$ & $3.86 \pm 0.03$ & $3.86 \pm 0.04$ \\
1.2 V & $1199 \pm 9$ & $3.86 \pm 0.03$ & $3.22 \pm 0.04$ \\
1.4 V & $1399 \pm 11$ & $3.88 \pm 0.03$ & $2.78 \pm 0.03$ \\
1.6 V & $1599 \pm 12$ & $3.89 \pm 0.03$ & $2.43 \pm 0.03$ \\
1.8 V & $1799 \pm 14$ & $3.90 \pm 0.03$ & $2.17 \pm 0.02$ \\
2 V & $1999 \pm 15$ & $3.92 \pm 0.03$ & $1.96 \pm 0.02$ \\
\bottomrule
\end{tabular} 
\caption{Misure di guadagno al variare della tensione in ingresso
all'amplificatore con $R_2^a = 5.1$k \label{tab: gain_B}}
\end{table}

\begin{table}[htb]
\centering
\begin{tabular}{cccc}
\toprule
$v\ped{in}(\si{m\V})$ (nom.) & $v\ped{in} \pm \sigma(v\ped{in})$ [mV] & $v\ped{out} \pm \sigma(v\ped{out})$ [V] & $A_v \pm \sigma(A_v)$ \\
\midrule
\midrule
40 & $40.1 \pm 0.2$ & $283 \pm 1.7 \; \si{m}$ & $7.06 \pm 0.06$ \\
60 & $59.8 \pm 0.3$ & $410 \pm 2 \; \si{m}$ & $6.86 \pm 0.06$ \\
80 & $79.9 \pm 1.1$ & $564 \pm 3 \; \si{m}$ & $7.06 \pm 0.06$ \\
100 & $100.1 \pm 1.2$ & $705 \pm 4 \; \si{m}$ & $7.04 \pm 0.06$ \\
200 & $200 \pm 2$ & $1412 \pm 8 \; \si{m}$ & $7.06 \pm 0.06$ \\
400 & $401 \pm 3$ & $2882 \pm 17 \; \si{m}$ & $7.04 \pm 0.06$ \\
600 & $601 \pm 5$ & $4.24 \pm 0.02$ & $7.05 \pm 0.06$ \\
800 & $801 \pm 6$ & $5.78 \pm 0.03$ & $7.21 \pm 0.06$ \\
900 & $900 \pm 6$ & $6.32 \pm 0.04$ & $7.00 \pm 0.06$ \\
1000 & $1000 \pm 7$ & $7.04 \pm 0.04$ & $7.02 \pm 0.06$ \\
\bottomrule
\end{tabular} 
\caption{Misure di guadagno al variare della tensione in ingresso
all'amplificatore con $R_2^a = 7$k \label{tab: gain_M}}
\end{table}

Con un fit lineare possiamo stimare il guadagno dell'amplificatore a partire
dal grafico di $v\ped{out} = A_v v\ped{in}$ al variare di $v\ped{in}$.
\begin{figure}[htb]
\centering
\includegraphics[scale=0.7]{gain5k1}
\caption{Fit lineare per l'andamento dell'uscita rispetto al segnale in
ingresso. \label{fig: gainfit}}
\end{figure}
Da cui troviamo i seguenti parametri per la retta di best-fit
\begin{align*}
\mathrm{intercetta} = -0.6 \pm 0.4 \; \si{m\V} \;\;\;\mathrm{pendenza} = 5.124 \pm 0.003 \;\;\;\mathrm{correlazione} 
= -0.72 \;\;\; \chi^2 = 0.2 \;\;\; d.o.f. = 10 \\
\text{coefficiente angolare/senza intercetta} = 5.120 \pm 0.002 \;\;\;
\chi^2 = 0.2 \;\;\; d.o.f. = 11
\end{align*}

Il valore atteso per il guadagno dal valore dei componenti in questa
configurazione del circuito è pari a
\[
A\ped{v, exp} = -\frac{R_2}{R_1} = - 5.13 \pm 0.12
\]
Questo è compatibile con quanto trovato sperimentalmente, specialmente
tenendo conto della notevole indeterminazione sul valore dei parametri di
costruzione dell'opamp.

\begin{figure}[htb]
\centering
\includegraphics[scale=0.7]{gainsat}
\caption{Andamento reale dell'uscita al variare dell'ampiezza del segnale in
ingresso oltre il regime lineare dell'amplificatore. \label{fig: gainsat}}
\end{figure}
\subsection{Impedenza in ingresso}
Inserendo in serie al generatore una resistenza $R_S$ dello stesso ordine di
$R\ped{in}$ attesa e misurando la tensione in uscita con o senza $R_S$ è
possibile dare un stima della resistenza in ingresso del circuito.
Detta $V_1$ la tensione $V\ped{out}$ misurata senza $R_S$ e $V_2$ la tensione
misurata con $R_S$ inserita, vale l'equazione:
\begin{equation}\label{eq: Zin}
\frac{R_S}{R\ped{in}} = \frac{V_1}{V_2} - 1
\end{equation}
Abbiamo preso come $R_S$ un'altra resistenza da $1 \pm 10\% \; \si{k\ohm}$
Per cui, avendo misurato $V_1 = 1412 \pm 8 \; \si{m\V}$ e
$V_2 = 2.822 \pm 0.017 \; \si{\V}$, troviamo come resistenza in ingresso:
\begin{align*}
{R\ped{in}} &= \frac{R_S}{V_1/V_2 - 1} = 1.00 \pm 0.02 \; \si{k\ohm}
\end{align*}
Che è compatibile entro l'incertezza con il valore atteso dalla
\eqref{eq: Zin}.

Per l'amplificatore di guadagno 5,
Per cui, avendo misurato $V_1 = 1022 \pm 8 \; \si{m\V}$ e
$V_2 = 512 \pm 4 \; \si{m\V}$, troviamo come resistenza in ingresso:
\begin{align*}
{R\ped{in}} &= \frac{R_S}{V_1/V_2 - 1} = 0.99 \pm 0.02 \; \si{k\ohm}
\end{align*}

\section{Risposta in frequenza e slew rate}
\subsection{Network analyzer}
Con l'aiuto dei cursori abbiamo misurato come guadagno a centro banda
per il circuito amplificatore con resistenza $R_2^a = 5.1 \; \si{k\ohm}$
$A_M = 14.18 \pm 0.09$
dunque abbiamo ricavato una stima della frequenza di taglio dell'amplificatore
invertente dal punto in cui il guadagno diminuisce di $-3.01 \; \si{dB}$
rispetto ad $A_M$:
$f_H = 388.0 \pm 1.1 \; \si{k\Hz}$
\begin{figure}[htb]
\centering
\includegraphics[scale=0.4]{opampbode}
\caption{Plot di Bode ottenuto dallo scan con Network tra $\SI{100}{\Hz}$ e
$\SI{5}{M\Hz}$ con un segnale sinusoidale in ingresso all'amplificatore
invertente di ampiezza costante $v\ped{in} = \SI{200}{m\V}$. \label{fig: invbode}}
\end{figure}

Se i due segnali sono in opposizione di fase il passaggio per 0 con la stessa
pendenza/slope devono distare un semi-periodo dall'altro; come si vede bene
dalla figura \ref{fig: Alin} in cui ai massimi del segnale in ingresso (la
traccia gialla) corrispondono i minimi del segnale in uscita (la traccia blu)
\begin{figure}[htb]
\centering
%\includegraphics[scale=0.335]{Alin200mV}
\caption{Risposta del circuito ad un segnale sinusoidale di ampiezza
$\SI{200}{m\V}$ e $f = \SI{1}{k\Hz}$ in ingresso. Quando l'amplificatore
è in pieno regime attivo. \label{fig: Alin}}
\end{figure}

Da una misura con i cursori troviamo
\begin{align*}
\Delta t &= 50.2 \pm 1.0 \; \si{n\s}\\
\Delta \phi &= 2\pi f \Delta t = 3.14 \pm 0.06 \; \si{\radian}
\end{align*}

mentre con la funzione di misura automatica definita con uno script di Wavegen
risulta:
\[
\phi = 179.63 \pm 0.10 \; \si{\degree}
\]

che sono entrambi compatibili con il valore atteso di $\Delta \phi\ped{exp}
= \pi \; \si{\radian}$ per la natura invertente dell'amplificatore.

\subsection{Misura dello slew rate}
Abbiamo inviato in ingresso all'amplificatore un'onda quadra di ampiezza
$\SI{2}{\V}$, al fronte di discesa dell'onda abbiamo trovato una rampa come
segnale in uscita, la cui pendenza è proprio lo slew rate dell'amplificatore.

Misurando con l'oscilloscopio l'ampiezza dei segnali in ingresso $v\ped{in}$
e in uscita $v\ped{out}$ dall'amplificatore possiamo ricavare una misura del
guadagno del circuito dal rapporto $A_v = \dfrac{v\ped{out}}{v\ped{in}}$.

Con un fit lineare possiamo stimare il guadagno dell'amplificatore a partire
dal grafico di $v\ped{out} = A_v v\ped{in}$ al variare di $v\ped{in}$.
\begin{figure}[htb]
\centering
\includegraphics[scale=0.35]{slew}
\caption{Fit lineare per l'andamento dell'uscita rispetto al segnale in
ingresso. \label{fig: slewrate}}
\end{figure}
Da cui troviamo i seguenti parametri per la retta di best-fit
\begin{align*}
\mathrm{intercetta} = -2 \pm 3 \;\;\;\mathrm{pendenza} = 9.66 \pm 0.03 \;\;\;\mathrm{correlazione} 
= -0.72 \;\;\; \chi^2 = 3 \;\;\; d.o.f. = 11 \\
\text{coefficiente angolare/senza intercetta} = 9.65 \pm 0.02 \;\;\;
\chi^2 = 3 \;\;\; d.o.f. = 12
\end{align*}

Il valore atteso per il guadagno dal valore dei componenti in questa
configurazione del circuito è pari a
\[
A\ped{v, exp} = -\frac{R_C}{R_E + h_{ie}/h_{fe}} = -9.44 \pm 0.12
\]
Questo è compatibile con quanto trovato sperimentalmente, specialmente
tenendo conto della notevole indeterminazione sul valore dei parametri di
costruzione del transistor.

\section{Circuito derivatore attivo}
Sempre usando i cursori abbiamo misurato come guadagno a centro banda
per il circuito derivatore $A_M =  \pm  \; \si{dB}$.

Dunque abbiamo ricavato una stima della frequenza di taglio dell'amplificatore
invertente dal punto in cui il guadagno diminuisce di $-3.01 \; \si{dB}$
rispetto ad $A_M$:
$f_c = \pm  \; \si{\Hz}$
\subsection{Risposta in frequenza}
\begin{figure}[htb]
\centering
\includegraphics[scale=0.4]{bode derivatore}
\caption{Plot di Bode ottenuto dallo scan con Network tra $\SI{100}{\Hz}$ e
$\SI{5}{M\Hz}$ con un segnale sinusoidale in ingresso al derivatore RC attivo
di ampiezza costante $v\ped{in} = \SI{200}{m\V}$.
\label{fig: derbode}}
\end{figure}

Come valore atteso per l'impedenza in ingresso al circuito abbiamo:
\[
Z\ped{in}(\omega) =
h_{ie} + h_{fe}Z_E(\omega) \; \lvert\rvert \; R_B =
\left(\frac{1}{h_{ie} + h_{fe}Z_E} + \frac{1}{R_1} + \frac{1}{R_2}\right)^{-1}
= 7.5 \pm 10\% \; \si{k\ohm} 
\]

dove abbiamo indicato con $Z_E(\omega)$ l'impedenza del ramo di emettitore,
che nel nostro circuito vale $Z_E = R_E$; meno che nel punto 5, dove in
parallelo a $R_E$ si aggiunge un passa alto costruito con $C_E + R\ped{es}$,
per cui vale $Z_E(\omega) = R_E || \left(R\ped{es} + \frac{1}{j \omega C_E}
\right)$.

\subsection{Risposta ad un'onda triangolare}
Si è inviato all'ingresso del filtro passa-alto un segnale triangolare di
ampiezza $v\ped{in} = \SI{200}{m\V}$ e frequenza $\SI{5}{k\Hz}$.

\begin{figure}[htb]
\centering
\includegraphics[scale=0.4]{derivatore}
\caption{Risposta del circuito ad un segnale triangolare di ampiezza
$\SI{200}{m\V}$ e $f = \SI{5}{k\Hz}$ in ingresso. \label{fig: dertrg}}
\end{figure}

Inserendo tra l'uscita e la massa una resistenza di carico $R_L$ dello stesso
ordine di $R\ped{out}$ e misurando la tensione di uscita con o senza
resistenza è possibile dare una stima della resistenza in uscita
dell'amplificatore.
Detta $V_1$ la tensione misurata senza $R_L$ e $V_2$ la tensione misurata
con $R_L$, vale la formula:
\begin{equation}\label{eq: Zout}
\frac{R\ped{out}}{R_L} = \frac{V_1}{V_2} -1
\end{equation}
Per cui, una volta misurate $V_1 = 1725 \pm 8 \; \si{m\V}$,
$V_2 = 866 \pm 4\; \si{m\V}$ e $R_L = 5.08 \pm 0.05 \si{k\ohm}$ abbiamo ottenuto come impedenza d'uscita:
\[
R\ped{out} = R_L \left(\frac{V_1}{V_2} - 1\right)
\]

Risulta $R\ped{out} = 5.0 \pm 0.1\; \si{k\ohm}$ che è compatibile con la stima iniziale dell'impedenza.

\subsection{Confronto con i valori attesi}

%=======================
\section{Circuito integratore attivo}
\subsection{Risposta in frequenza}
Di nuovo utilizzando i cursori abbiamo misurato come guadagno a centro banda
per il circuito integratore attivo $A_M = 19.92 \pm 0.09 \; \si{dB}$.

Dunque abbiamo ricavato una stima della frequenza di taglio dell'amplificatore
invertente dal punto in cui il guadagno diminuisce di $-3.01 \; \si{dB}$
rispetto ad $A_M$:
$f_c = 342.5 \pm 0.5 \; \si{\Hz}$
\begin{figure}[htb]
\centering
\includegraphics[scale=0.35]{bode integratore}
\caption{Plot di Bode ottenuto dallo scan con Network tra $\SI{10}{\Hz}$ e
$\SI{5}{M\Hz}$ con un segnale sinusoidale in ingresso all'integratore RC
attivo di ampiezza costante $v\ped{in} = \SI{200}{m\V}$.
\label{fig: intbode}}
\end{figure}

\subsection{Risposta ad un'onda quadra @ 10 kHz}
Si è inviato all'ingresso del filtro passa-basso un'onda quadra di
ampiezza $v\ped{in} = \SI{200}{m\V}$ e frequenza $10.02 \pm 0.12 \; \si{k\Hz}$.

$$v\ped{in} = 200 \pm 2 \; \si{m\V}$$
$$v\ped{out} = 107.3 \pm 1.3 \; \si{m\V}$$
$$A_v = \frac{v\ped{out}}{v\ped{in}} = 0.537 \pm 0.008$$

\begin{figure}[htb]
\centering
\includegraphics[scale=0.335]{integratore}
\caption{Risposta del circuito ad un'onda quadra di ampiezza
$\SI{200}{m\V}$ e $f = \SI{10}{k\Hz}$ in ingresso. \label{fig: intsqw}}
\end{figure}

Partendo da una misura con i cursori del guadagno a centro banda,
$A_V = 19.65 \pm 0.05 \; \si{dB} = 9.65 \pm 0.08$, possiamo ottenere una stima del valore
delle frequenze di taglio a bassa $f_L$ e ad alta frequenza $f_H$ dai punti
in cui il guadagno diminuisce di un fattore $1/\sqrt{2}$, cioè di circa
$-3.01 \; \si{dB}$ rispetto ad $A_V$.
\begin{align*}
f_L &= 80.77 \pm 0.12 \; \si{\Hz}\\
f_H &= 646.1 \pm 0.5 \; \si{k\Hz}
\end{align*}

Trascurando le capacità delle giunzioni nel transistor ci aspettiamo che
la frequenza di taglio ``bassa'' corrisponda a quella di un filtro passa~alto
costituito dalla serie $C\ped{in} + R_B$
\begin{equation}
f\ped{L, exp} = \frac{1}{2\pi R_B C\ped{in}} = 83 \pm 4 \; \si{\Hz}
\end{equation} 
che è in accordo con il valore misurato.

Mentre per la frequenza di taglio ``alta'' la resistenza in uscita è data
da $R_C$, per cui la capacità in serie dev'essere dell'ordine delle centinaia
di pF per avere ordine di grandezza compatibile con il valore misurato.
Ma nel datasheet risulta al massimo $C\ped{ibo} \approx \SI{25}{p\F}$, per cui
è difficile stabilire un valore di riferimento per la frequenza $f_H$ attesa.

Per frequenze $f \ll f_c$ come è ragionevole aspettarsi, la forma d'onda in
uscita non è apprezzabilmente cambiata rispetto all'onda quadra in ingresso,
ma risulta soltanto amplificata in ampiezza di un fattore $A_M \sim 10$.

Per frequenze $f \gg f_c$ il filtro è in regime di taglio, per cui si comporta
come un integratore, dunque la forma d'onda in uscita è un'onda triangolare di
ampiezza sempre minore al crescere della frequenza.

Nel regime intermedio $f \sim f_c$ all'uscita del filtro RC osserviamo un'onda
"a pinna di squalo" che corrispondono alle rampe di carica e scarica del
condensatore al passaggio da basso ad alto e viceversa dell'onda quadra in
ingresso.
\begin{figure}[htb]
\centering
\includegraphics[scale=0.335]{intfin}
\caption{Onda a pinna di squalo in risposta ad un'onda quadra di ampiezza
$\SI{200}{m\V}$ e $f = 500 \pm 6 \; \si{Hz}$ in ingresso al circuito
integratore. \label{fig: intfin}}
\end{figure}
\section{Circuito amplificatore non invertente}
Per mitigare la diminuzione del guadagno dovuta alla resistenza tra emettitore
e $V_{EE}$ si inserisce in parallelo a questa la serie $R\ped{es} + C_E$,
in modo tale che $R_E$ sia vista ``per intero'' solamente in condizioni
stazionarie (cioè dalle tensioni e correnti continue di alimentazione).
Al contrario, per frequenze abbastanza alte il condensatore si comporterà come
un corto circuito, per cui la resistenza del parallelo tenderà al valore più
piccolo tra le due resistenze, cioè $R\ped{es} \ll R_E$.
Quindi in breve l'impedenza all'emettitore si comporterà grossolanamente
come un filtro passa alto.

\subsection{Risposta in frequenza}

\begin{figure}[htb]
\centering
%\includegraphics[scale=0.35]{1-10Mnet}
\caption{Plot di Bode ottenuto dallo scan con Network tra $\SI{100}{\Hz}$ e
$\SI{5}{M\Hz}$ con un segnale sinusoidale in ingresso all'amplificatore
non-invertente di ampiezza costante $v\ped{in} = \SI{200}{m\V}$.
\label{fig: ampbode}}
\end{figure}

\subsection{Misure di guadagno e frequenza di taglio}
Partendo da una misura con i cursori del guadagno a centro banda,
$A_V = 19.65 \pm 0.05 \; \si{dB} = 9.65 \pm 0.08$, possiamo ottenere una stima del valore
delle frequenze di taglio a bassa $f_L$ e ad alta frequenza $f_H$ dai punti
in cui il guadagno diminuisce di un fattore $1/\sqrt{2}$, cioè di circa
$-3.01 \; \si{dB}$ rispetto ad $A_V$.
\begin{align*}
f_L &= 80.77 \pm 0.12 \; \si{\Hz}\\
f_H &= 646.1 \pm 0.5 \; \si{k\Hz}
\end{align*}

Una volta inserito il ramo in parallelo a $R_E$, dalla formula per il guadagno
atteso otteniamo
\[
A_v = -\frac{R_C}{\abs{Z_E}} =
- \frac{R_C}{R_E \; \lvert \rvert \; \left(R\ped{es} + \abs{1/j\omega C_E}
\right)} =
- R_C \abs{\frac{1}{R_E} + \frac{1}{R\ped{es} + 1/\omega C_E}}
\]

Visto che abbiamo scelto $C_E \gg C\ped{in} \sim C\ped{out}$, alla frequenza
di lavoro $f = \SI{10}{k\Hz}$ possiamo considerare trascurabile l'impedenza
del condensatore $\abs{Z_{C_E}} = \dfrac{1}{2\pi f C_E} \approx 0.1 \si{\ohm}
\ll R\ped{es}$, per cui in buona approssimazione ci aspettiamo
\[
\abs{A_v} \approx
\frac{R_C}{R_E \; \lvert \rvert \; R\ped{es}} =
R_C \abs{\frac{1}{R_E} + \frac{1}{R\ped{es}}} \approx
\frac{R_C}{R\ped{es}} = 110 \pm 1
\]

Questo però assumendo che l'impedenza del transistor sia trascurabile rispetto
a $Z_E$, o meglio $\abs{Z_E} \gg \dfrac{h_{ie}}{h_{fe}}$
\begin{align*}
\abs{Z_E} &= \abs{\frac{1}{R_E} + \frac{1}{R\ped{es} + 1/\omega C_E}}^{-1} =
45 \pm 2 \; \si{\ohm} \\
\frac{h_{ie}}{h_{fe}} &\approx \SI{40}{\ohm}
\end{align*}
che non risulta affatto verificata.

Considerando nel modello anche l'impedenza in ingresso del transistor in
serie a quella del ramo $Z_E$ avremo come valore atteso per il guadagno
\begin{equation}
A_v = \frac{R_C}{\abs{Z_E} + h_{ie}/h_{fe}} \approx 60
\end{equation}

Che è in buon accordo con il valore misurato per il guadagno sempre
entro le grandi incertezze relative sui parametri di costruzione del
transistor.

\begin{figure}[htb]
\centering
%\includegraphics[scale=0.335]{Alin200mV}
\caption{Sovrapposizione dei plot di Bode ottenuti per l'amplificatore
non-invertente. \label{fig: prdbode}}
\end{figure}

\section*{Conclusioni e commenti finali}
Si è riusciti a costruire e studiare alcuni dei circuiti più comuni che si
possono realizzare con un amplificatore operazionale, tra cui: due filtri
attivi, passa-basso e passa-alto, un amplificatore di tensione invertente
(e uno non).
In particolare siamo riusciti ad apprezzare il differente comportamento dei
circuiti (anche in regime non lineare) dare una stima di guadagno, impedenza di
ingresso e frequenze caratteristiche della loro risposta in frequenza.

\section*{Dichiarazione}
I firmatari di questa relazione dichiarano che il contenuto della relazione \`e
originale, con misure effettuate dai membri del gruppo, e che tutti i firmatari
hanno contribuito alla elaborazione della relazione stessa.

\end{document}
